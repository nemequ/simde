/* SPDX-License-Identifier: MIT
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 * Copyright:
 *   2020      Evan Nemerson <evan@nemerson.com>
 *   2020      Ashleigh Newman-Jones <ashnewman-jones@hotmail.co.uk>
 */

#define SIMDE_TEST_X86_AVX512_INSN maddubs

#include <test/x86/avx512/test-avx512.h>
#include <simde/x86/avx512/maddubs.h>

static int
test_simde_mm_mask_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const int16_t src[8];
    const simde__mmask8 k;
    const uint8_t a[16];
    const int8_t  b[16];
    const int16_t r[8];
  } test_vec[] = {
    { {  INT16_C(  5717), -INT16_C( 11056),  INT16_C( 24116), -INT16_C( 26113), -INT16_C( 11845), -INT16_C( 27426),  INT16_C(   305), -INT16_C( 25055) },
      UINT8_C(165),
      { UINT8_C(156), UINT8_C(183), UINT8_C(  3), UINT8_C(217), UINT8_C( 34), UINT8_C(184), UINT8_C( 35), UINT8_C(  3),
        UINT8_C(241), UINT8_C(247), UINT8_C(119), UINT8_C( 60), UINT8_C( 82), UINT8_C(183), UINT8_C(146), UINT8_C(104) },
      { -INT8_C( 121),  INT8_C( 102), -INT8_C( 100), -INT8_C(  27),  INT8_C( 102),  INT8_C(  54), -INT8_C(  96),  INT8_C(  55),
         INT8_C(  20),  INT8_C(  52),  INT8_C( 105),  INT8_C(  21),  INT8_C(  85),  INT8_C(   7), -INT8_C(  70), -INT8_C(  15) },
      { -INT16_C(   210), -INT16_C( 11056),  INT16_C( 13404), -INT16_C( 26113), -INT16_C( 11845),  INT16_C( 13755),  INT16_C(   305), -INT16_C( 11780) } },
    { { -INT16_C( 16706), -INT16_C(  7734), -INT16_C(  4490),  INT16_C( 26852),  INT16_C( 23781),  INT16_C( 14244),  INT16_C( 13843), -INT16_C( 25953) },
      UINT8_C(157),
      { UINT8_C( 59), UINT8_C(127), UINT8_C(  3), UINT8_C(113), UINT8_C( 31), UINT8_C( 58), UINT8_C(133), UINT8_C( 83),
        UINT8_C(163), UINT8_C(155), UINT8_C(168), UINT8_C(171), UINT8_C( 85), UINT8_C(153), UINT8_C(105), UINT8_C( 19) },
      {  INT8_C( 100),  INT8_C(  74), -INT8_C( 118),  INT8_C(  82),  INT8_C(  47), -INT8_C(  14),  INT8_C(  55), -INT8_C( 117),
        -INT8_C( 106),  INT8_C( 110), -INT8_C(  98), -INT8_C(  51),  INT8_C(  13),  INT8_C(  56),  INT8_C( 106),  INT8_C(  72) },
      {  INT16_C( 15298), -INT16_C(  7734),  INT16_C(   645), -INT16_C(  2396), -INT16_C(   228),  INT16_C( 14244),  INT16_C( 13843),  INT16_C( 12498) } },
    { {  INT16_C( 28087), -INT16_C( 10566),  INT16_C( 16295),  INT16_C( 19241), -INT16_C( 11814),  INT16_C( 12534),  INT16_C( 24426), -INT16_C( 12733) },
      UINT8_C(170),
      { UINT8_C(205), UINT8_C( 32), UINT8_C(217), UINT8_C(191), UINT8_C( 87), UINT8_C(100), UINT8_C( 86), UINT8_C(197),
        UINT8_C(  2), UINT8_C( 35), UINT8_C(210), UINT8_C( 58), UINT8_C(141), UINT8_C( 27), UINT8_C(241), UINT8_C(250) },
      { -INT8_C(  43), -INT8_C(  57), -INT8_C(  95),  INT8_C(  20), -INT8_C(  16), -INT8_C(  20), -INT8_C(  17), -INT8_C(  63),
        -INT8_C(  30),  INT8_C(  31),  INT8_C(  43),  INT8_C(  66),  INT8_C(  98), -INT8_C(   6), -INT8_C(  20),  INT8_C(  48) },
      {  INT16_C( 28087), -INT16_C( 16795),  INT16_C( 16295), -INT16_C( 13873), -INT16_C( 11814),  INT16_C( 12858),  INT16_C( 24426),  INT16_C(  7180) } },
    { { -INT16_C( 15078),  INT16_C( 29423),  INT16_C( 17705),  INT16_C( 11063),  INT16_C(  2664), -INT16_C(  2715),  INT16_C( 22053), -INT16_C(  1297) },
      UINT8_C( 29),
      { UINT8_C(145), UINT8_C( 14), UINT8_C( 13), UINT8_C(125), UINT8_C(253), UINT8_C(206), UINT8_C( 96), UINT8_C( 28),
        UINT8_C(249), UINT8_C(162), UINT8_C(127), UINT8_C(243), UINT8_C(142), UINT8_C(175), UINT8_C( 14), UINT8_C( 83) },
      { -INT8_C(  98),      INT8_MIN,  INT8_C( 124), -INT8_C(  28), -INT8_C(  73), -INT8_C(  89),  INT8_C(  76), -INT8_C(  63),
         INT8_C(  12),  INT8_C(  66), -INT8_C(  26),  INT8_C(  98),  INT8_C(  49), -INT8_C(  32),      INT8_MAX, -INT8_C(  62) },
      { -INT16_C( 16002),  INT16_C( 29423),       INT16_MIN,  INT16_C(  5532),  INT16_C( 13680), -INT16_C(  2715),  INT16_C( 22053), -INT16_C(  1297) } },
    { { -INT16_C( 29457), -INT16_C(  5056), -INT16_C( 24486),  INT16_C( 21257), -INT16_C( 30654), -INT16_C( 12217),  INT16_C( 21815), -INT16_C( 10973) },
      UINT8_C(213),
      { UINT8_C(159), UINT8_C(185), UINT8_C(140), UINT8_C( 70), UINT8_C(  6), UINT8_C( 78), UINT8_C( 82), UINT8_C( 72),
        UINT8_C( 52), UINT8_C(180), UINT8_C(121), UINT8_C( 21), UINT8_C( 51), UINT8_C( 60), UINT8_C(  4), UINT8_C(191) },
      {  INT8_C( 124), -INT8_C(  16),  INT8_C(  25),  INT8_C(  28), -INT8_C(   7),  INT8_C( 108),  INT8_C(  94), -INT8_C( 127),
        -INT8_C(  77),  INT8_C(  46), -INT8_C(  72),  INT8_C(   8),  INT8_C(  81), -INT8_C( 114), -INT8_C(  35), -INT8_C(  16) },
      {  INT16_C( 16756), -INT16_C(  5056),  INT16_C(  8382),  INT16_C( 21257),  INT16_C(  4276), -INT16_C( 12217), -INT16_C(  2709), -INT16_C(  3196) } },
    { {  INT16_C( 27207),  INT16_C( 19766), -INT16_C( 30536), -INT16_C(  4971),  INT16_C(  3900),  INT16_C( 28417),  INT16_C(  1355), -INT16_C( 14546) },
      UINT8_C(246),
      { UINT8_C( 71), UINT8_C(227), UINT8_C(239), UINT8_C(179), UINT8_C( 65), UINT8_C(113), UINT8_C(103), UINT8_C(111),
        UINT8_C( 41), UINT8_C(111), UINT8_C(192), UINT8_C(183), UINT8_C( 77), UINT8_C(176),    UINT8_MAX, UINT8_C(183) },
      { -INT8_C(  26),  INT8_C(  76),  INT8_C( 111),  INT8_C( 110), -INT8_C(  30),  INT8_C(  91), -INT8_C(  86), -INT8_C(  15),
         INT8_C(  93),  INT8_C(  25),  INT8_C(  60),  INT8_C(  98),  INT8_C(  71),  INT8_C(   3),  INT8_C(  88), -INT8_C( 114) },
      {  INT16_C( 27207),       INT16_MAX,  INT16_C(  8333), -INT16_C(  4971),  INT16_C(  6588),  INT16_C( 29454),  INT16_C(  5995),  INT16_C(  1578) } },
    { {  INT16_C( 18662),  INT16_C( 10049), -INT16_C( 22343), -INT16_C(  7530),  INT16_C( 22040),  INT16_C( 26010), -INT16_C( 26362), -INT16_C(  5092) },
      UINT8_C(229),
      { UINT8_C(139), UINT8_C( 90), UINT8_C(199), UINT8_C(230), UINT8_C(  4), UINT8_C(184), UINT8_C( 67), UINT8_C( 29),
        UINT8_C(244), UINT8_C(166), UINT8_C(100), UINT8_C(247), UINT8_C(254), UINT8_C(242), UINT8_C(221), UINT8_C( 70) },
      {  INT8_C(  51),  INT8_C(   4), -INT8_C(   1), -INT8_C(  36), -INT8_C( 102), -INT8_C(  30), -INT8_C(  12), -INT8_C(  16),
         INT8_C( 124),  INT8_C(  89), -INT8_C(  10),  INT8_C(  21),  INT8_C( 117), -INT8_C(  30), -INT8_C(   6),  INT8_C(   0) },
      {  INT16_C(  7449),  INT16_C( 10049), -INT16_C(  5928), -INT16_C(  7530),  INT16_C( 22040),  INT16_C(  4187),  INT16_C( 22458), -INT16_C(  1326) } },
    { { -INT16_C( 15812),  INT16_C( 16614),  INT16_C( 10874),  INT16_C( 28509), -INT16_C( 15920), -INT16_C( 12698),  INT16_C( 17587), -INT16_C(  6379) },
      UINT8_C( 72),
      { UINT8_C( 20), UINT8_C(195), UINT8_C(227), UINT8_C(246), UINT8_C(183), UINT8_C(211), UINT8_C(114), UINT8_C( 16),
        UINT8_C(202), UINT8_C(135), UINT8_C(133), UINT8_C(172), UINT8_C(130), UINT8_C(133), UINT8_C(233), UINT8_C( 68) },
      {  INT8_C( 107),  INT8_C(  41), -INT8_C(  66), -INT8_C( 107), -INT8_C( 121),  INT8_C(  45),  INT8_C( 101),  INT8_C(  72),
        -INT8_C( 108),  INT8_C(  52), -INT8_C(   4), -INT8_C(  40),  INT8_C(  73), -INT8_C(  29),  INT8_C(  32),  INT8_C(  93) },
      { -INT16_C( 15812),  INT16_C( 16614),  INT16_C( 10874),  INT16_C( 12666), -INT16_C( 15920), -INT16_C( 12698),  INT16_C(  5633), -INT16_C(  6379) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m128i src = simde_mm_loadu_epi16(test_vec[i].src);
    simde__m128i a = simde_mm_loadu_epi8(test_vec[i].a);
    simde__m128i b = simde_mm_loadu_epi8(test_vec[i].b);
    simde__m128i r = simde_mm_mask_maddubs_epi16(src, test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x8(r, simde_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm_maskz_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const simde__mmask8 k;
    const uint8_t a[16];
    const int8_t  b[16];
    const int16_t r[8];
  } test_vec[] = {
    { UINT8_C(231),
      { UINT8_C(106), UINT8_C(199), UINT8_C(104), UINT8_C( 59), UINT8_C( 79), UINT8_C(224), UINT8_C(132), UINT8_C( 64),
        UINT8_C(238), UINT8_C(241), UINT8_C( 42), UINT8_C( 68), UINT8_C( 79), UINT8_C(157), UINT8_C( 97), UINT8_C(235) },
      { -INT8_C( 107), -INT8_C(  20),  INT8_C(  73), -INT8_C(  57), -INT8_C(  85),  INT8_C(  89),  INT8_C(  64), -INT8_C(  95),
        -INT8_C( 114),  INT8_C(  18), -INT8_C( 109), -INT8_C(   4),  INT8_C( 118),  INT8_C( 102), -INT8_C(  29), -INT8_C(  32) },
      { -INT16_C( 15322),  INT16_C(  4229),  INT16_C( 13221),  INT16_C(     0),  INT16_C(     0), -INT16_C(  4850),  INT16_C( 25336), -INT16_C( 10333) } },
    { UINT8_C( 45),
      { UINT8_C( 76), UINT8_C( 27), UINT8_C(125), UINT8_C( 44), UINT8_C(159), UINT8_C(189), UINT8_C( 26), UINT8_C(145),
        UINT8_C(231), UINT8_C( 94), UINT8_C(224), UINT8_C(132), UINT8_C(191), UINT8_C(203), UINT8_C( 25), UINT8_C(171) },
      {  INT8_C(  20), -INT8_C(  32),  INT8_C(  87),  INT8_C( 109),  INT8_C(  33), -INT8_C(   8), -INT8_C(   5),  INT8_C(  51),
        -INT8_C( 117), -INT8_C(   8), -INT8_C(  87), -INT8_C(  15), -INT8_C(  37), -INT8_C( 119),  INT8_C(  31),  INT8_C(  39) },
      {  INT16_C(   656),  INT16_C(     0),  INT16_C(  3735),  INT16_C(  7265),  INT16_C(     0), -INT16_C( 21468),  INT16_C(     0),  INT16_C(     0) } },
    { UINT8_C(165),
      { UINT8_C(156), UINT8_C( 83), UINT8_C( 68), UINT8_C( 89), UINT8_C(109), UINT8_C(213), UINT8_C( 64), UINT8_C(204),
        UINT8_C(181), UINT8_C(196), UINT8_C(139), UINT8_C(128), UINT8_C(221), UINT8_C( 55), UINT8_C(148), UINT8_C(189) },
      { -INT8_C( 114),  INT8_C(   2), -INT8_C(  34), -INT8_C( 122), -INT8_C(   3),  INT8_C(  18),  INT8_C(  17), -INT8_C(  11),
        -INT8_C(  69),  INT8_C(   3), -INT8_C(  47),  INT8_C(  69),  INT8_C(  34), -INT8_C(   8), -INT8_C(  22), -INT8_C(  66) },
      { -INT16_C( 17618),  INT16_C(     0),  INT16_C(  3507),  INT16_C(     0),  INT16_C(     0),  INT16_C(  2299),  INT16_C(     0), -INT16_C( 15730) } },
    { UINT8_C( 76),
      { UINT8_C( 46), UINT8_C( 23), UINT8_C(185), UINT8_C(  4), UINT8_C( 87), UINT8_C(133), UINT8_C(185), UINT8_C( 27),
        UINT8_C( 17), UINT8_C( 58), UINT8_C(248), UINT8_C( 72), UINT8_C(206), UINT8_C(181), UINT8_C(214), UINT8_C(208) },
      { -INT8_C( 108),  INT8_C(  92), -INT8_C(  50), -INT8_C(  90),  INT8_C( 109), -INT8_C(  61),  INT8_C(  97),  INT8_C( 112),
        -INT8_C( 108), -INT8_C(  90), -INT8_C( 110), -INT8_C( 115), -INT8_C( 112),  INT8_C(  80), -INT8_C(  39), -INT8_C(  65) },
      {  INT16_C(     0),  INT16_C(     0),  INT16_C(  1370),  INT16_C( 20969),  INT16_C(     0),  INT16_C(     0), -INT16_C(  8592),  INT16_C(     0) } },
    { UINT8_C(103),
      { UINT8_C(146), UINT8_C(195), UINT8_C(190), UINT8_C( 24), UINT8_C(124), UINT8_C(217), UINT8_C( 41), UINT8_C(182),
        UINT8_C(209), UINT8_C(113), UINT8_C(133), UINT8_C(135), UINT8_C( 71), UINT8_C( 85), UINT8_C( 27), UINT8_C(163) },
      {  INT8_C(  35), -INT8_C(  63),  INT8_C(  16), -INT8_C(  25),  INT8_C(  34), -INT8_C( 127),  INT8_C( 123), -INT8_C(  55),
         INT8_C(  19),  INT8_C(   8),  INT8_C(  89),  INT8_C( 100), -INT8_C(  31),  INT8_C(  24), -INT8_C(  53),  INT8_C( 116) },
      { -INT16_C(  7175),  INT16_C(  2440), -INT16_C( 23343),  INT16_C(     0),  INT16_C(     0),  INT16_C( 25337), -INT16_C(   161),  INT16_C(     0) } },
    { UINT8_C(219),
      { UINT8_C(138), UINT8_C(140), UINT8_C( 88), UINT8_C( 99), UINT8_C(181), UINT8_C( 14), UINT8_C( 53), UINT8_C( 38),
        UINT8_C(147), UINT8_C(188), UINT8_C(109), UINT8_C(233), UINT8_C(215), UINT8_C( 16), UINT8_C( 12), UINT8_C(152) },
      {  INT8_C(  32), -INT8_C(  13), -INT8_C(  70), -INT8_C(  95),  INT8_C( 111), -INT8_C( 125), -INT8_C(  75),  INT8_C( 119),
        -INT8_C(  35),  INT8_C(  25),  INT8_C(  89), -INT8_C(  11), -INT8_C(  28), -INT8_C(  51), -INT8_C(  47),  INT8_C( 110) },
      {  INT16_C(  2596), -INT16_C( 15565),  INT16_C(     0),  INT16_C(   547), -INT16_C(   445),  INT16_C(     0), -INT16_C(  6836),  INT16_C( 16156) } },
    { UINT8_C( 89),
      { UINT8_C( 41), UINT8_C(210), UINT8_C( 14), UINT8_C( 55), UINT8_C(  7), UINT8_C( 52), UINT8_C(203), UINT8_C(195),
        UINT8_C(161), UINT8_C(180), UINT8_C(154), UINT8_C(177), UINT8_C(192), UINT8_C( 50), UINT8_C(209), UINT8_C(180) },
      { -INT8_C(  20),  INT8_C( 115),  INT8_C(  35),  INT8_C( 112),  INT8_C(  40), -INT8_C( 102),  INT8_C(  77),  INT8_C(  65),
        -INT8_C(  13),  INT8_C(  66),  INT8_C(  37), -INT8_C(  64),  INT8_C(  19), -INT8_C( 108),  INT8_C(  25),  INT8_C(  60) },
      {  INT16_C( 23330),  INT16_C(     0),  INT16_C(     0),  INT16_C( 28306),  INT16_C(  9787),  INT16_C(     0), -INT16_C(  1752),  INT16_C(     0) } },
    { UINT8_C(102),
      { UINT8_C( 39), UINT8_C(116), UINT8_C(109), UINT8_C( 91), UINT8_C( 63), UINT8_C( 48), UINT8_C(252), UINT8_C(243),
        UINT8_C(202), UINT8_C(173), UINT8_C(179), UINT8_C(252), UINT8_C(127), UINT8_C(103), UINT8_C(232), UINT8_C(242) },
      { -INT8_C( 118),  INT8_C(  88),  INT8_C(  26),  INT8_C(  37), -INT8_C(  91),  INT8_C(  91),  INT8_C(  24), -INT8_C(  24),
             INT8_MIN, -INT8_C(  39), -INT8_C(   5),  INT8_C(  20), -INT8_C(  14),  INT8_C(  56),  INT8_C( 122),  INT8_C(  26) },
      {  INT16_C(     0),  INT16_C(  6201), -INT16_C(  1365),  INT16_C(     0),  INT16_C(     0),  INT16_C(  4145),  INT16_C(  3990),  INT16_C(     0) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m128i a = simde_mm_loadu_epi8(test_vec[i].a);
    simde__m128i b = simde_mm_loadu_epi8(test_vec[i].b);
    simde__m128i r = simde_mm_maskz_maddubs_epi16(test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x8(r, simde_x_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm256_mask_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const int16_t src[16];
    const simde__mmask16 k;
    const uint8_t a[32];
    const int8_t  b[32];
    const int16_t r[16];
  } test_vec[] = {
    { {  INT16_C(  3145), -INT16_C(  4397), -INT16_C( 30196), -INT16_C( 21778), -INT16_C(  6690), -INT16_C(  4793),  INT16_C( 30259),  INT16_C( 16863),
        -INT16_C( 22551),  INT16_C(  8921),  INT16_C( 29263),  INT16_C( 11564),  INT16_C( 29746),  INT16_C( 25844),  INT16_C( 21717),  INT16_C(  7982) },
      UINT16_C(  352),
      { UINT8_C( 13), UINT8_C(109), UINT8_C(139), UINT8_C(251), UINT8_C( 23), UINT8_C(105), UINT8_C(225), UINT8_C( 94),
        UINT8_C( 87), UINT8_C( 20), UINT8_C(213), UINT8_C( 54), UINT8_C( 85), UINT8_C(190), UINT8_C(221), UINT8_C( 47),
        UINT8_C(225), UINT8_C( 44), UINT8_C(161), UINT8_C( 13), UINT8_C( 89), UINT8_C(211), UINT8_C(129), UINT8_C( 77),
        UINT8_C( 55), UINT8_C( 87), UINT8_C(161), UINT8_C(101), UINT8_C(118), UINT8_C(  2), UINT8_C(102), UINT8_C(131) },
      {  INT8_C( 111), -INT8_C(  14),      INT8_MAX, -INT8_C( 122),  INT8_C(  91),  INT8_C(  96), -INT8_C(  27), -INT8_C(  78),
         INT8_C( 116), -INT8_C(  70), -INT8_C(  23), -INT8_C(  54),  INT8_C( 120), -INT8_C(  58), -INT8_C(   7),  INT8_C(  89),
        -INT8_C(  13), -INT8_C( 102),  INT8_C( 102),  INT8_C(  76),  INT8_C( 109), -INT8_C(  24), -INT8_C( 102), -INT8_C(  92),
         INT8_C(  63),  INT8_C(  59),  INT8_C(   9), -INT8_C(  75),  INT8_C(  61),  INT8_C( 111),  INT8_C(  56), -INT8_C(  84) },
      {  INT16_C(  3145), -INT16_C(  4397), -INT16_C( 30196), -INT16_C( 21778), -INT16_C(  6690), -INT16_C(  7815), -INT16_C(   820),  INT16_C( 16863),
        -INT16_C(  7413),  INT16_C(  8921),  INT16_C( 29263),  INT16_C( 11564),  INT16_C( 29746),  INT16_C( 25844),  INT16_C( 21717),  INT16_C(  7982) } },
    { { -INT16_C( 18591), -INT16_C( 17101),  INT16_C(  6167), -INT16_C( 29585),  INT16_C( 22738),  INT16_C( 19030),  INT16_C( 20255),  INT16_C(  4772),
         INT16_C(  2793),  INT16_C( 22110), -INT16_C(  1806),  INT16_C( 12794),  INT16_C(   820),  INT16_C( 29158),  INT16_C(  8050), -INT16_C( 11234) },
      UINT16_C(20950),
      { UINT8_C(145), UINT8_C(238), UINT8_C(105), UINT8_C(  0), UINT8_C(122), UINT8_C( 59), UINT8_C( 89), UINT8_C(208),
        UINT8_C(133), UINT8_C(120), UINT8_C( 31), UINT8_C( 41), UINT8_C(138), UINT8_C(  8), UINT8_C( 52), UINT8_C(232),
        UINT8_C( 94), UINT8_C( 38), UINT8_C(225), UINT8_C( 88), UINT8_C( 88), UINT8_C( 21), UINT8_C( 91), UINT8_C( 62),
        UINT8_C(134), UINT8_C(205), UINT8_C( 93), UINT8_C(164), UINT8_C(161), UINT8_C( 52), UINT8_C(245), UINT8_C( 50) },
      {  INT8_C(  34),  INT8_C(  94),  INT8_C(  51), -INT8_C( 100), -INT8_C( 103), -INT8_C( 116),  INT8_C( 108),  INT8_C(  31),
         INT8_C(   4), -INT8_C( 117),  INT8_C(  72), -INT8_C( 114), -INT8_C( 109),  INT8_C( 124),  INT8_C( 118), -INT8_C(  15),
        -INT8_C(  93),  INT8_C(  87),  INT8_C(  73), -INT8_C(   5),  INT8_C( 108), -INT8_C(  92),  INT8_C(  57), -INT8_C(  13),
         INT8_C( 113), -INT8_C( 105), -INT8_C( 105),  INT8_C(  19), -INT8_C(  53), -INT8_C( 115),  INT8_C(  69), -INT8_C(  19) },
      { -INT16_C( 18591),  INT16_C(  5355), -INT16_C( 19410), -INT16_C( 29585), -INT16_C( 13508),  INT16_C( 19030), -INT16_C( 14050),  INT16_C(  2656),
        -INT16_C(  5436),  INT16_C( 22110), -INT16_C(  1806),  INT16_C( 12794), -INT16_C(  6383),  INT16_C( 29158), -INT16_C( 14513), -INT16_C( 11234) } },
    { {  INT16_C( 30955), -INT16_C( 31351), -INT16_C(  2812),  INT16_C(  2212), -INT16_C(  4992),  INT16_C(  5014),  INT16_C(  3433),  INT16_C(  3076),
         INT16_C( 19812), -INT16_C( 12025),  INT16_C( 16625),  INT16_C( 25284),  INT16_C( 23511), -INT16_C( 23947), -INT16_C( 17432), -INT16_C( 11121) },
      UINT16_C( 6195),
      { UINT8_C( 89), UINT8_C( 56), UINT8_C( 13), UINT8_C(253), UINT8_C( 64), UINT8_C(141), UINT8_C(233), UINT8_C(215),
        UINT8_C(160), UINT8_C( 82), UINT8_C(228), UINT8_C(164), UINT8_C( 94), UINT8_C( 72), UINT8_C(241), UINT8_C(101),
        UINT8_C( 25), UINT8_C(226), UINT8_C(166), UINT8_C(221), UINT8_C( 69), UINT8_C(125), UINT8_C( 57), UINT8_C(186),
        UINT8_C( 32), UINT8_C( 33), UINT8_C(117), UINT8_C(175), UINT8_C(245), UINT8_C(169), UINT8_C(200), UINT8_C( 78) },
      { -INT8_C(  31), -INT8_C(  43),  INT8_C(  75),  INT8_C(  33),  INT8_C(  99),  INT8_C(  53), -INT8_C(   8),  INT8_C(   3),
        -INT8_C( 121), -INT8_C(  36), -INT8_C(  88), -INT8_C(  26),  INT8_C(  37), -INT8_C( 103),  INT8_C(  75),  INT8_C(  62),
         INT8_C( 124), -INT8_C(  15),  INT8_C(  28), -INT8_C(  63),  INT8_C( 111),  INT8_C(  85),  INT8_C( 123), -INT8_C( 113),
         INT8_C( 118), -INT8_C(  15),  INT8_C(  62),  INT8_C( 108), -INT8_C( 102),  INT8_C(   6), -INT8_C(  70),  INT8_C( 123) },
      { -INT16_C(  5167),  INT16_C(  9324), -INT16_C(  2812),  INT16_C(  2212), -INT16_C( 22312), -INT16_C( 24328),  INT16_C(  3433),  INT16_C(  3076),
         INT16_C( 19812), -INT16_C( 12025),  INT16_C( 16625), -INT16_C( 14007),  INT16_C(  3281), -INT16_C( 23947), -INT16_C( 17432), -INT16_C( 11121) } },
    { {  INT16_C(  1756),  INT16_C( 16284), -INT16_C( 27333), -INT16_C( 15806), -INT16_C(  5519), -INT16_C( 26968), -INT16_C(  2940),  INT16_C(   213),
        -INT16_C(  3611),  INT16_C( 21697),  INT16_C( 15430), -INT16_C( 17181),  INT16_C(  8749), -INT16_C( 14552), -INT16_C(  7384),  INT16_C(  1090) },
      UINT16_C(57321),
      { UINT8_C( 67), UINT8_C( 36), UINT8_C(116), UINT8_C(134), UINT8_C(230), UINT8_C(229), UINT8_C(112), UINT8_C(143),
        UINT8_C(124), UINT8_C(244), UINT8_C(131), UINT8_C( 81), UINT8_C(244), UINT8_C(104), UINT8_C( 66), UINT8_C(181),
        UINT8_C(189), UINT8_C(136), UINT8_C(242), UINT8_C(160), UINT8_C( 68), UINT8_C( 31), UINT8_C(194), UINT8_C(109),
        UINT8_C(231), UINT8_C(235), UINT8_C( 80), UINT8_C( 41), UINT8_C(239), UINT8_C( 57), UINT8_C(  8), UINT8_C( 51) },
      {  INT8_C(  93),  INT8_C( 124), -INT8_C(  71),  INT8_C(  67),  INT8_C(  98),  INT8_C(  41), -INT8_C(  46), -INT8_C(  34),
         INT8_C(  30),  INT8_C(  85),  INT8_C(  47),  INT8_C(  18), -INT8_C(  66),  INT8_C( 113), -INT8_C(  56),  INT8_C( 123),
        -INT8_C(   7), -INT8_C(  70),  INT8_C(  27),  INT8_C(  61), -INT8_C(  39), -INT8_C(  34), -INT8_C(  86), -INT8_C(  64),
        -INT8_C(  55), -INT8_C(   6), -INT8_C(  22), -INT8_C(  72),  INT8_C(  51), -INT8_C(  14), -INT8_C(  21), -INT8_C( 112) },
      {  INT16_C( 10695),  INT16_C( 16284), -INT16_C( 27333), -INT16_C( 10014), -INT16_C(  5519),  INT16_C(  7615), -INT16_C(  4352),  INT16_C( 18567),
        -INT16_C( 10843),  INT16_C( 16294), -INT16_C(  3706), -INT16_C( 23660), -INT16_C( 14115), -INT16_C( 14552),  INT16_C( 11391), -INT16_C(  5880) } },
    { { -INT16_C( 23441), -INT16_C( 11820), -INT16_C( 22834), -INT16_C(  4945), -INT16_C(  8452), -INT16_C( 17666), -INT16_C( 14769),  INT16_C( 18485),
         INT16_C( 20608),  INT16_C( 23173),  INT16_C( 12334), -INT16_C(  2278),  INT16_C(  1066),  INT16_C( 24240), -INT16_C( 25609),  INT16_C( 26350) },
      UINT16_C(49728),
      { UINT8_C( 55), UINT8_C( 14), UINT8_C(105), UINT8_C(230), UINT8_C(250), UINT8_C(101), UINT8_C(196), UINT8_C(248),
        UINT8_C( 31), UINT8_C( 19), UINT8_C(191), UINT8_C( 84), UINT8_C( 91), UINT8_C( 63), UINT8_C(164), UINT8_C(224),
        UINT8_C(153), UINT8_C(211), UINT8_C( 16), UINT8_C(180), UINT8_C(202), UINT8_C( 59), UINT8_C(184), UINT8_C(122),
        UINT8_C(153), UINT8_C(175), UINT8_C( 22), UINT8_C(135), UINT8_C( 21), UINT8_C( 86), UINT8_C( 74), UINT8_C( 76) },
      {  INT8_C( 100), -INT8_C(  77),  INT8_C(  50),  INT8_C(  94),  INT8_C(  24), -INT8_C(  10),  INT8_C(  86),  INT8_C(  55),
         INT8_C(   9),  INT8_C(  21), -INT8_C( 117),  INT8_C( 100),  INT8_C(  85),  INT8_C(  47),  INT8_C(  69), -INT8_C(  18),
         INT8_C(   2),  INT8_C(  85), -INT8_C(  94), -INT8_C(  51), -INT8_C( 112),  INT8_C(  91),  INT8_C(  71),  INT8_C(  41),
         INT8_C(  10),  INT8_C(  93), -INT8_C(  79),  INT8_C(  32), -INT8_C(  77), -INT8_C(   5),  INT8_C( 108),  INT8_C(  23) },
      { -INT16_C( 23441), -INT16_C( 11820), -INT16_C( 22834), -INT16_C(  4945), -INT16_C(  8452), -INT16_C( 17666),  INT16_C( 10696),  INT16_C( 18485),
         INT16_C( 20608), -INT16_C( 10684),  INT16_C( 12334), -INT16_C(  2278),  INT16_C(  1066),  INT16_C( 24240), -INT16_C(  2047),  INT16_C(  9740) } },
    { { -INT16_C( 24658), -INT16_C( 14731), -INT16_C( 13163), -INT16_C( 24579), -INT16_C( 30495),  INT16_C( 13827),  INT16_C( 18615), -INT16_C( 17883),
        -INT16_C( 14434),  INT16_C( 11911), -INT16_C( 12766),  INT16_C( 11608),  INT16_C(  2348), -INT16_C(  8371), -INT16_C( 18172), -INT16_C( 19721) },
      UINT16_C(27736),
      { UINT8_C(120), UINT8_C(238), UINT8_C( 56), UINT8_C(117), UINT8_C(141), UINT8_C( 26), UINT8_C(253), UINT8_C(144),
        UINT8_C( 80), UINT8_C(180), UINT8_C(217), UINT8_C(117), UINT8_C(110), UINT8_C(119), UINT8_C( 61), UINT8_C(245),
        UINT8_C(165), UINT8_C( 95), UINT8_C(196), UINT8_C(253), UINT8_C(140), UINT8_C(240), UINT8_C(  6), UINT8_C(217),
        UINT8_C(207), UINT8_C( 10), UINT8_C(147), UINT8_C(198), UINT8_C(188), UINT8_C(235), UINT8_C( 51), UINT8_C( 52) },
      { -INT8_C(  39),  INT8_C( 107), -INT8_C(  87),  INT8_C( 102), -INT8_C( 123), -INT8_C(  90), -INT8_C(   9), -INT8_C(  42),
         INT8_C(  91), -INT8_C(  48),  INT8_C(  75), -INT8_C(  55),  INT8_C(  71), -INT8_C( 120), -INT8_C(  65), -INT8_C(  20),
        -INT8_C(  24), -INT8_C( 125), -INT8_C(  22),  INT8_C( 116),  INT8_C( 115), -INT8_C(  16),  INT8_C(  78),  INT8_C(  66),
        -INT8_C(   5), -INT8_C(  31),  INT8_C(   9), -INT8_C(  73), -INT8_C(  52),  INT8_C(  60), -INT8_C(  20), -INT8_C(  90) },
      { -INT16_C( 24658), -INT16_C( 14731), -INT16_C( 13163), -INT16_C(  8325), -INT16_C(  1360),  INT16_C( 13827), -INT16_C(  6470), -INT16_C( 17883),
        -INT16_C( 14434),  INT16_C( 11911),  INT16_C( 12260),  INT16_C( 14790),  INT16_C(  2348), -INT16_C( 13131),  INT16_C(  4324), -INT16_C( 19721) } },
    { { -INT16_C( 27225),  INT16_C( 11532),  INT16_C(   828), -INT16_C( 26877),  INT16_C( 20179),  INT16_C(  6752),  INT16_C(  8151), -INT16_C( 16633),
        -INT16_C(  3678),  INT16_C(  5427), -INT16_C( 32287), -INT16_C(  9128),  INT16_C( 24930),  INT16_C( 12180), -INT16_C( 32611),  INT16_C( 17621) },
      UINT16_C(57621),
      { UINT8_C(113), UINT8_C( 81), UINT8_C(229), UINT8_C(116), UINT8_C(232), UINT8_C(184), UINT8_C(195), UINT8_C( 73),
        UINT8_C(211), UINT8_C(154), UINT8_C(104), UINT8_C(218), UINT8_C( 89), UINT8_C( 11), UINT8_C(203), UINT8_C(140),
        UINT8_C( 32), UINT8_C(172), UINT8_C( 14), UINT8_C(120), UINT8_C(137), UINT8_C(112), UINT8_C(217), UINT8_C( 29),
        UINT8_C(159), UINT8_C(118), UINT8_C(157), UINT8_C(116), UINT8_C(187), UINT8_C(178), UINT8_C( 86), UINT8_C( 44) },
      {  INT8_C(   4),  INT8_C(  59), -INT8_C(  95), -INT8_C(  20), -INT8_C(  13),  INT8_C( 100),  INT8_C(  53), -INT8_C(  58),
        -INT8_C(   2), -INT8_C(  98), -INT8_C(  96),  INT8_C(  87), -INT8_C(  87),  INT8_C( 107), -INT8_C(  29), -INT8_C(  55),
         INT8_C(  24), -INT8_C(  15),  INT8_C(  66), -INT8_C(  95),  INT8_C(  98),  INT8_C(  27), -INT8_C(  66),  INT8_C(   1),
        -INT8_C( 110),  INT8_C(  91),  INT8_C( 118),  INT8_C(  77),  INT8_C(  13), -INT8_C(  52),  INT8_C( 121),  INT8_C(  17) },
      {  INT16_C(  5231),  INT16_C( 11532),  INT16_C( 15384), -INT16_C( 26877), -INT16_C( 15514),  INT16_C(  6752),  INT16_C(  8151), -INT16_C( 16633),
        -INT16_C(  1812),  INT16_C(  5427), -INT16_C( 32287), -INT16_C(  9128),  INT16_C( 24930),  INT16_C( 27458), -INT16_C(  6825),  INT16_C( 11154) } },
    { {  INT16_C(  6663), -INT16_C(  1282),  INT16_C( 13182),  INT16_C( 31937),  INT16_C( 25041),  INT16_C( 31443), -INT16_C( 18483), -INT16_C(  6844),
        -INT16_C( 31064),  INT16_C(  2694),  INT16_C( 17569),  INT16_C( 13068), -INT16_C( 32097), -INT16_C( 21376), -INT16_C(  1458),  INT16_C( 21950) },
      UINT16_C(48148),
      { UINT8_C( 79), UINT8_C(147), UINT8_C(239), UINT8_C( 16), UINT8_C( 15), UINT8_C(193), UINT8_C(114), UINT8_C(227),
        UINT8_C( 59), UINT8_C( 63), UINT8_C(154), UINT8_C(127), UINT8_C( 36), UINT8_C( 66), UINT8_C(  5), UINT8_C(170),
        UINT8_C( 77), UINT8_C(167), UINT8_C(238), UINT8_C( 89), UINT8_C(218), UINT8_C(141), UINT8_C(219), UINT8_C( 91),
        UINT8_C( 57), UINT8_C( 41), UINT8_C( 85), UINT8_C(247), UINT8_C(126), UINT8_C(105), UINT8_C(179), UINT8_C(205) },
      { -INT8_C(   4), -INT8_C(  93), -INT8_C(  34),  INT8_C(  12),  INT8_C( 100),  INT8_C(  80), -INT8_C(  17), -INT8_C(  97),
        -INT8_C( 113), -INT8_C( 119),  INT8_C(  31), -INT8_C(  77), -INT8_C(  53),  INT8_C(  36),  INT8_C(  93),  INT8_C(  24),
        -INT8_C(  53),  INT8_C(  75),  INT8_C( 113), -INT8_C(  90), -INT8_C(  40),  INT8_C(  76),  INT8_C(   1),  INT8_C(  17),
         INT8_C( 117),  INT8_C(  86),  INT8_C(   9), -INT8_C(  13), -INT8_C(  65), -INT8_C(  68), -INT8_C(  63), -INT8_C(  68) },
      {  INT16_C(  6663), -INT16_C(  1282),  INT16_C( 16940),  INT16_C( 31937), -INT16_C( 14164),  INT16_C( 31443), -INT16_C( 18483), -INT16_C(  6844),
        -INT16_C( 31064),  INT16_C(  2694),  INT16_C(  1996),  INT16_C(  1766),  INT16_C( 10195), -INT16_C(  2446), -INT16_C(  1458), -INT16_C( 25217) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m256i src = simde_x_mm256_loadu_epi16(test_vec[i].src);
    simde__m256i a = simde_x_mm256_loadu_epi16(test_vec[i].a);
    simde__m256i b = simde_x_mm256_loadu_epi16(test_vec[i].b);
    simde__m256i r = simde_mm256_mask_maddubs_epi16(src, test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x16(r, simde_x_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm256_maskz_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const simde__mmask16 k;
    const uint8_t a[32];
    const int8_t  b[32];
    const int16_t r[16];
  } test_vec[] = {
    { UINT16_C(32179),
      { UINT8_C(192), UINT8_C(165), UINT8_C( 42), UINT8_C(254), UINT8_C( 95), UINT8_C( 16), UINT8_C(132), UINT8_C(165),
        UINT8_C(182), UINT8_C(100), UINT8_C(115), UINT8_C(252), UINT8_C( 68), UINT8_C(225), UINT8_C( 96), UINT8_C(212),
        UINT8_C(222), UINT8_C(112), UINT8_C( 28), UINT8_C( 82), UINT8_C( 19), UINT8_C(132), UINT8_C(196), UINT8_C(234),
        UINT8_C(133), UINT8_C( 46), UINT8_C(207), UINT8_C(191), UINT8_C( 67), UINT8_C(130), UINT8_C( 60), UINT8_C(  4) },
      {  INT8_C(  40),  INT8_C( 103),  INT8_C(   2), -INT8_C( 121),  INT8_C( 119), -INT8_C( 122),  INT8_C(  45),  INT8_C(  45),
        -INT8_C(  22), -INT8_C(  96),  INT8_C(  41),  INT8_C(  46), -INT8_C( 127), -INT8_C( 118),  INT8_C(   3),  INT8_C(  96),
        -INT8_C(   6),  INT8_C(  31), -INT8_C(  78),  INT8_C(  13), -INT8_C(  93),  INT8_C( 118), -INT8_C(   9),  INT8_C(  40),
        -INT8_C(  92), -INT8_C(  58), -INT8_C(  25), -INT8_C(  24),  INT8_C(  73),  INT8_C(  36), -INT8_C(  20),  INT8_C( 113) },
      {  INT16_C( 24675), -INT16_C( 30650),  INT16_C(     0),  INT16_C(     0), -INT16_C( 13604),  INT16_C( 16307),  INT16_C(     0),  INT16_C( 20640),
         INT16_C(  2140),  INT16_C(     0),  INT16_C( 13809),  INT16_C(  7596), -INT16_C( 14904), -INT16_C(  9759),  INT16_C(  9571),  INT16_C(     0) } },
    { UINT16_C(61067),
      { UINT8_C(248), UINT8_C(  2), UINT8_C(116), UINT8_C( 37), UINT8_C( 47), UINT8_C( 95), UINT8_C(198), UINT8_C( 89),
        UINT8_C(141), UINT8_C( 71), UINT8_C(227), UINT8_C(144), UINT8_C(167), UINT8_C(221), UINT8_C(175), UINT8_C( 90),
        UINT8_C(235), UINT8_C( 82), UINT8_C(208), UINT8_C(226), UINT8_C(122), UINT8_C(117), UINT8_C(169), UINT8_C( 98),
        UINT8_C( 93), UINT8_C(242), UINT8_C(134), UINT8_C( 73), UINT8_C( 99), UINT8_C( 17), UINT8_C( 55), UINT8_C( 91) },
      {  INT8_C(  19), -INT8_C(  85), -INT8_C( 127),  INT8_C(  66),  INT8_C(  10),  INT8_C(  71), -INT8_C( 101), -INT8_C( 104),
        -INT8_C( 114),  INT8_C( 126),  INT8_C(  40),  INT8_C(  54),  INT8_C(  92), -INT8_C(  40), -INT8_C( 112),  INT8_C(  71),
         INT8_C(  42),  INT8_C(  96),  INT8_C(  41), -INT8_C(  91), -INT8_C(  43), -INT8_C(  46),  INT8_C(   7),  INT8_C(  50),
        -INT8_C(  60), -INT8_C( 115),  INT8_C( 123),  INT8_C(  39), -INT8_C(  98), -INT8_C(  78), -INT8_C( 125), -INT8_C(  79) },
      {  INT16_C(  4542), -INT16_C( 12290),  INT16_C(     0), -INT16_C( 29254),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 13210),
         INT16_C(     0), -INT16_C( 12038), -INT16_C( 10628),  INT16_C(  6083),  INT16_C(     0),  INT16_C( 19329), -INT16_C( 11028), -INT16_C( 14064) } },
    { UINT16_C( 1118),
      { UINT8_C(243), UINT8_C(104), UINT8_C( 75), UINT8_C(143), UINT8_C(  0), UINT8_C(217), UINT8_C( 13), UINT8_C( 41),
        UINT8_C( 15), UINT8_C(105), UINT8_C(  1), UINT8_C(159), UINT8_C(176), UINT8_C( 43), UINT8_C(  0), UINT8_C(218),
        UINT8_C(208), UINT8_C(213), UINT8_C(172), UINT8_C(215), UINT8_C(  8), UINT8_C(113), UINT8_C(100), UINT8_C(131),
        UINT8_C(152), UINT8_C(  2), UINT8_C( 54), UINT8_C( 27), UINT8_C(179), UINT8_C(148), UINT8_C( 31), UINT8_C(167) },
      { -INT8_C(   4),  INT8_C( 106),  INT8_C(  54), -INT8_C(   3),  INT8_C(  68),  INT8_C(  67),  INT8_C(  38),  INT8_C(  83),
        -INT8_C(  83),  INT8_C(  39), -INT8_C(  13),  INT8_C(  93),  INT8_C(  82), -INT8_C(  13),  INT8_C(  55),  INT8_C(  35),
        -INT8_C(  56), -INT8_C(  28), -INT8_C(   6), -INT8_C(  48),  INT8_C(  85),  INT8_C(  95),  INT8_C(  84), -INT8_C(  19),
         INT8_C(  97), -INT8_C( 118),  INT8_C(   9),  INT8_C(  21),  INT8_C(  30),  INT8_C(  40), -INT8_C(  68),  INT8_C(  26) },
      {  INT16_C(     0),  INT16_C(  3621),  INT16_C( 14539),  INT16_C(  3897),  INT16_C(  2850),  INT16_C(     0),  INT16_C( 13873),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0),  INT16_C( 11415),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0) } },
    { UINT16_C(62099),
      { UINT8_C( 23), UINT8_C(215), UINT8_C( 53), UINT8_C( 61), UINT8_C( 42), UINT8_C(226), UINT8_C(100), UINT8_C( 29),
        UINT8_C( 64), UINT8_C(183), UINT8_C( 16), UINT8_C(119), UINT8_C(218), UINT8_C(217), UINT8_C( 91), UINT8_C(212),
        UINT8_C(169), UINT8_C(176), UINT8_C( 51), UINT8_C(253), UINT8_C(158), UINT8_C(149), UINT8_C(135), UINT8_C(167),
        UINT8_C(170), UINT8_C(165), UINT8_C(207), UINT8_C(102), UINT8_C(192), UINT8_C( 98), UINT8_C( 88), UINT8_C(215) },
      {  INT8_C(  57), -INT8_C( 115),  INT8_C(  21),  INT8_C( 100),  INT8_C( 112),  INT8_C( 121), -INT8_C( 127), -INT8_C(  80),
         INT8_C(  48), -INT8_C( 110),  INT8_C(  39),  INT8_C(  10),  INT8_C( 107), -INT8_C( 125), -INT8_C(  33),  INT8_C(  20),
         INT8_C(  51),  INT8_C(  18),  INT8_C(  18), -INT8_C(  47), -INT8_C(  89), -INT8_C( 103),  INT8_C( 120),  INT8_C(  81),
         INT8_C(  63),  INT8_C(  72), -INT8_C(  73), -INT8_C(   1), -INT8_C(  86),  INT8_C(  15), -INT8_C(  42), -INT8_C(  28) },
      { -INT16_C( 23414),  INT16_C(  7213),  INT16_C(     0),  INT16_C(     0), -INT16_C( 17058),  INT16_C(     0),  INT16_C(     0),  INT16_C(  1237),
         INT16_C(     0), -INT16_C( 10973),  INT16_C(     0),  INT16_C(     0),  INT16_C( 22590), -INT16_C( 15213), -INT16_C( 15042), -INT16_C(  9716) } },
    { UINT16_C(60317),
      { UINT8_C( 72), UINT8_C( 13), UINT8_C(101), UINT8_C(201), UINT8_C(189), UINT8_C(149), UINT8_C( 91), UINT8_C(228),
        UINT8_C(160), UINT8_C(198), UINT8_C(103), UINT8_C(127), UINT8_C(219), UINT8_C(155), UINT8_C(145), UINT8_C(237),
        UINT8_C(108), UINT8_C( 57), UINT8_C(134), UINT8_C(229), UINT8_C(138), UINT8_C(197), UINT8_C( 45), UINT8_C( 66),
        UINT8_C(196), UINT8_C(215), UINT8_C( 81), UINT8_C(155), UINT8_C(187), UINT8_C(238), UINT8_C(134), UINT8_C(  3) },
      { -INT8_C(   5), -INT8_C(  21), -INT8_C(  51), -INT8_C(  72), -INT8_C( 127),  INT8_C(  40), -INT8_C(  99),  INT8_C(  33),
        -INT8_C(  17),  INT8_C(   4), -INT8_C(  96), -INT8_C(  54), -INT8_C(  97),  INT8_C(  49), -INT8_C(  73),  INT8_C(  12),
         INT8_C( 106),  INT8_C(  61), -INT8_C(  15), -INT8_C(  11),  INT8_C(   3),  INT8_C(  30),  INT8_C(  55), -INT8_C(  57),
        -INT8_C(  11), -INT8_C( 120),  INT8_C(  98), -INT8_C(  79),  INT8_C( 119), -INT8_C(  23), -INT8_C(  76),  INT8_C( 114) },
      { -INT16_C(   633),  INT16_C(     0), -INT16_C( 18043), -INT16_C(  1485), -INT16_C(  1928),  INT16_C(     0),  INT16_C(     0), -INT16_C(  7741),
         INT16_C( 14925), -INT16_C(  4529),  INT16_C(     0), -INT16_C(  1287),  INT16_C(     0), -INT16_C(  4307),  INT16_C( 16779), -INT16_C(  9842) } },
    { UINT16_C(33236),
      { UINT8_C( 43), UINT8_C( 85), UINT8_C(170), UINT8_C(200), UINT8_C(118), UINT8_C(153), UINT8_C(204), UINT8_C( 22),
        UINT8_C( 99), UINT8_C(108), UINT8_C( 72), UINT8_C( 26), UINT8_C(120), UINT8_C(178), UINT8_C( 87), UINT8_C(105),
        UINT8_C(167), UINT8_C( 90), UINT8_C(135), UINT8_C(222), UINT8_C( 34), UINT8_C(124), UINT8_C(103), UINT8_C(132),
        UINT8_C( 45), UINT8_C(222), UINT8_C(109), UINT8_C(226), UINT8_C( 80), UINT8_C( 66), UINT8_C( 99), UINT8_C(123) },
      { -INT8_C( 105),  INT8_C(  13),  INT8_C(  67),  INT8_C(  14), -INT8_C(  90),  INT8_C(  16),  INT8_C(  36),  INT8_C(   9),
         INT8_C( 124),  INT8_C( 108),  INT8_C(  35), -INT8_C(  12),  INT8_C(  31),  INT8_C( 123),  INT8_C(  93), -INT8_C(  58),
        -INT8_C(  43), -INT8_C(  28), -INT8_C(  91), -INT8_C(   9),  INT8_C(  96),  INT8_C(  12),  INT8_C( 124), -INT8_C( 114),
        -INT8_C(  22), -INT8_C(  23),  INT8_C( 112),  INT8_C(  58),  INT8_C(  43), -INT8_C(  45), -INT8_C(  74), -INT8_C(  61) },
      {  INT16_C(     0),  INT16_C(     0), -INT16_C(  8172),  INT16_C(     0),  INT16_C( 23940),  INT16_C(     0),  INT16_C( 25614),  INT16_C(  2001),
        -INT16_C(  9701),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 14829) } },
    { UINT16_C(63969),
      { UINT8_C(209), UINT8_C(135), UINT8_C(  9), UINT8_C(245), UINT8_C(145), UINT8_C(133), UINT8_C( 98), UINT8_C(180),
        UINT8_C(121), UINT8_C(129), UINT8_C( 47), UINT8_C(214), UINT8_C( 71), UINT8_C(  5), UINT8_C(186), UINT8_C(236),
        UINT8_C(252), UINT8_C( 27), UINT8_C(248), UINT8_C(120), UINT8_C(169), UINT8_C(226), UINT8_C( 98), UINT8_C( 25),
        UINT8_C( 29), UINT8_C(141), UINT8_C(236), UINT8_C(211), UINT8_C( 80), UINT8_C(205), UINT8_C(204), UINT8_C( 33) },
      {  INT8_C(  85), -INT8_C(  42),  INT8_C(  23), -INT8_C(  26),  INT8_C(  91),  INT8_C( 121), -INT8_C( 102), -INT8_C(  43),
        -INT8_C(   6), -INT8_C(  54), -INT8_C(  85),  INT8_C(  65), -INT8_C(  49),  INT8_C( 102),  INT8_C(  46), -INT8_C(  53),
        -INT8_C( 127),  INT8_C(  38),  INT8_C(  68),  INT8_C(  42),  INT8_C(   9), -INT8_C(  90),  INT8_C(  67),  INT8_C(  38),
         INT8_C(  51),  INT8_C(  47), -INT8_C(   7), -INT8_C( 124), -INT8_C(   3), -INT8_C(  59), -INT8_C(  91),  INT8_C(  82) },
      {  INT16_C( 12095),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  9915), -INT16_C(  2969), -INT16_C(  3952),
        -INT16_C( 30978),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7516),  INT16_C(  8106), -INT16_C( 27816), -INT16_C( 12335), -INT16_C( 15858) } },
    { UINT16_C(48283),
      { UINT8_C( 56), UINT8_C(247), UINT8_C( 53), UINT8_C(210), UINT8_C(204), UINT8_C( 47), UINT8_C(156), UINT8_C(119),
        UINT8_C(113), UINT8_C(107), UINT8_C(221), UINT8_C(159), UINT8_C( 55), UINT8_C( 94), UINT8_C(197), UINT8_C(123),
        UINT8_C(136), UINT8_C(206), UINT8_C( 33), UINT8_C(203), UINT8_C(244), UINT8_C( 84), UINT8_C(251), UINT8_C(237),
        UINT8_C(216), UINT8_C(248), UINT8_C(179), UINT8_C(126), UINT8_C( 74), UINT8_C( 78), UINT8_C( 58), UINT8_C(130) },
      {  INT8_C(  69),  INT8_C( 112),  INT8_C(  84),  INT8_C(  17), -INT8_C(  97), -INT8_C(  15), -INT8_C( 119),  INT8_C(  16),
         INT8_C(  92),  INT8_C( 102), -INT8_C(  81), -INT8_C( 109), -INT8_C(  59),  INT8_C( 117),  INT8_C(  14),  INT8_C(  77),
         INT8_C(  67),  INT8_C(  47),  INT8_C(  25),  INT8_C(  56), -INT8_C( 124),  INT8_C(  20),  INT8_C(  37),  INT8_C(  92),
         INT8_C(  12), -INT8_C(  40), -INT8_C(  38),  INT8_C(  86),  INT8_C(  39),  INT8_C(  21), -INT8_C(  40),  INT8_C( 108) },
      {  INT16_C( 31528),  INT16_C(  8022),  INT16_C(     0), -INT16_C( 16660),  INT16_C( 21310),  INT16_C(     0),  INT16_C(     0),  INT16_C( 12229),
         INT16_C(     0),  INT16_C(     0), -INT16_C( 28576),  INT16_C( 31091), -INT16_C(  7328),  INT16_C(  4034),  INT16_C(     0),  INT16_C( 11720) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m256i a = simde_x_mm256_loadu_epi16(test_vec[i].a);
    simde__m256i b = simde_x_mm256_loadu_epi16(test_vec[i].b);
    simde__m256i r = simde_mm256_maskz_maddubs_epi16(test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x16(r, simde_x_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm512_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const uint8_t a[64];
    const int8_t b[64];
    const int16_t r[32];
  } test_vec[] = {
    { { UINT8_C( 21), UINT8_C(248), UINT8_C(177), UINT8_C( 16), UINT8_C(142), UINT8_C(104), UINT8_C(186), UINT8_C( 95),
        UINT8_C(181), UINT8_C( 90), UINT8_C(214), UINT8_C( 49), UINT8_C(124), UINT8_C(209), UINT8_C(118), UINT8_C(175),
        UINT8_C(204), UINT8_C(157), UINT8_C(179), UINT8_C( 54), UINT8_C(102), UINT8_C( 55), UINT8_C( 89), UINT8_C(250),
        UINT8_C(200), UINT8_C( 38), UINT8_C(180), UINT8_C(119), UINT8_C( 61), UINT8_C(  1), UINT8_C( 36), UINT8_C( 82),
        UINT8_C(249), UINT8_C(214), UINT8_C( 99), UINT8_C(136), UINT8_C( 62), UINT8_C( 29), UINT8_C(231), UINT8_C(243),
        UINT8_C(119), UINT8_C(190), UINT8_C( 36), UINT8_C(243), UINT8_C(143), UINT8_C(155), UINT8_C(162), UINT8_C( 91),
        UINT8_C( 56), UINT8_C( 85), UINT8_C(145), UINT8_C(158), UINT8_C(141), UINT8_C(234), UINT8_C(152), UINT8_C( 85),
        UINT8_C( 17), UINT8_C( 76), UINT8_C(204), UINT8_C( 78), UINT8_C( 77), UINT8_C(241), UINT8_C(160), UINT8_C( 71) },
      { -INT8_C(  57),  INT8_C(   3), -INT8_C(  49),  INT8_C(   5),  INT8_C(  32), -INT8_C(  74), -INT8_C(   7), -INT8_C( 105),
         INT8_C( 116),  INT8_C(  29), -INT8_C( 118),  INT8_C(   3), -INT8_C(  72),  INT8_C(  45),  INT8_C(  94), -INT8_C(  15),
        -INT8_C( 126), -INT8_C(  16), -INT8_C( 113),  INT8_C(  15), -INT8_C(  38),  INT8_C(  40),  INT8_C( 101), -INT8_C(  21),
         INT8_C( 116),  INT8_C(  49),  INT8_C(  57), -INT8_C(  62),  INT8_C(  34), -INT8_C(  38),  INT8_C(   9), -INT8_C(  23),
        -INT8_C(  35), -INT8_C(  40), -INT8_C(  17), -INT8_C(   2), -INT8_C( 114), -INT8_C(  24), -INT8_C( 107),  INT8_C(   3),
         INT8_C(   5),  INT8_C(  32),  INT8_C(   6), -INT8_C(  66),  INT8_C(  77),  INT8_C( 101), -INT8_C(  81), -INT8_C(  49),
         INT8_C(  85),  INT8_C(  62), -INT8_C(  33),  INT8_C(  47),  INT8_C( 102),  INT8_C(  68),  INT8_C(  27), -INT8_C(  37),
         INT8_C( 117),  INT8_C(  84), -INT8_C(  99), -INT8_C( 104),  INT8_C(  46), -INT8_C(  90), -INT8_C( 127),  INT8_C(  12) },
      { -INT16_C(   453), -INT16_C(  8593), -INT16_C(  3152), -INT16_C( 11277),  INT16_C( 23606), -INT16_C( 25105),  INT16_C(   477),  INT16_C(  8467),
        -INT16_C( 28216), -INT16_C( 19417), -INT16_C(  1676),  INT16_C(  3739),  INT16_C( 25062),  INT16_C(  2882),  INT16_C(  2036), -INT16_C(  1562),
        -INT16_C( 17275), -INT16_C(  1955), -INT16_C(  7764), -INT16_C( 23988),  INT16_C(  6675), -INT16_C( 15822),  INT16_C( 26666), -INT16_C( 17581),
         INT16_C( 10030),  INT16_C(  2641),  INT16_C( 30294),  INT16_C(   959),  INT16_C(  8373), -INT16_C( 28308), -INT16_C( 18148), -INT16_C( 19468) } },
    { { UINT8_C(126), UINT8_C(112), UINT8_C( 10), UINT8_C( 12), UINT8_C( 88), UINT8_C(159), UINT8_C( 15), UINT8_C( 94),
        UINT8_C(191), UINT8_C( 22), UINT8_C( 28), UINT8_C( 12), UINT8_C(123), UINT8_C(203), UINT8_C(220), UINT8_C(208),
        UINT8_C(  9), UINT8_C(187),    UINT8_MAX, UINT8_C(112),    UINT8_MAX, UINT8_C( 26), UINT8_C( 75), UINT8_C(116),
        UINT8_C(111), UINT8_C(232), UINT8_C( 12), UINT8_C(157), UINT8_C(142), UINT8_C(142), UINT8_C(169), UINT8_C( 12),
        UINT8_C(254), UINT8_C(179), UINT8_C( 24), UINT8_C( 87), UINT8_C( 83), UINT8_C( 40), UINT8_C(181), UINT8_C( 18),
        UINT8_C( 62), UINT8_C(209), UINT8_C( 31), UINT8_C(185), UINT8_C(156), UINT8_C(251), UINT8_C(137), UINT8_C(165),
        UINT8_C(182), UINT8_C(136), UINT8_C( 21), UINT8_C(181), UINT8_C(163), UINT8_C( 96), UINT8_C( 41), UINT8_C( 18),
        UINT8_C( 72), UINT8_C( 54), UINT8_C(175), UINT8_C(214), UINT8_C(196), UINT8_C( 89), UINT8_C(226), UINT8_C(194) },
      {  INT8_C(  12), -INT8_C(   5),  INT8_C(  25),  INT8_C(  95),  INT8_C(  35), -INT8_C(  50),  INT8_C( 114),  INT8_C(  97),
        -INT8_C(  97), -INT8_C( 111),  INT8_C(  26),  INT8_C(  59), -INT8_C( 116), -INT8_C(  93), -INT8_C(  31),  INT8_C(  66),
         INT8_C(  43), -INT8_C(  10), -INT8_C(   9), -INT8_C(  50),  INT8_C(  87),  INT8_C(  32), -INT8_C(  32), -INT8_C(  97),
         INT8_C(  86), -INT8_C( 112),  INT8_C( 118),  INT8_C(  26), -INT8_C(  23),  INT8_C(  88), -INT8_C(  35), -INT8_C(  11),
         INT8_C(  83), -INT8_C(  10),  INT8_C(  85),  INT8_C( 118), -INT8_C(  59), -INT8_C(  57), -INT8_C(  41),  INT8_C( 100),
         INT8_C(  88), -INT8_C(  15), -INT8_C(  96), -INT8_C(  28), -INT8_C( 108), -INT8_C( 127),  INT8_C(  38), -INT8_C(  64),
         INT8_C( 119),  INT8_C(  29), -INT8_C( 114), -INT8_C(  50),  INT8_C(  61),  INT8_C( 111),  INT8_C( 110), -INT8_C( 108),
        -INT8_C(   1), -INT8_C(  28), -INT8_C(  82), -INT8_C(  24),  INT8_C(  60), -INT8_C( 117), -INT8_C(  35), -INT8_C( 112) },
      {  INT16_C(   952),  INT16_C(  1390), -INT16_C(  4870),  INT16_C( 10828), -INT16_C( 20969),  INT16_C(  1436),       INT16_MIN,  INT16_C(  6908),
        -INT16_C(  1483), -INT16_C(  7895),  INT16_C( 23017), -INT16_C( 13652), -INT16_C( 16438),  INT16_C(  5498),  INT16_C(  9230), -INT16_C(  6047),
         INT16_C( 19292),  INT16_C( 12306), -INT16_C(  7177), -INT16_C(  5621),  INT16_C(  2321), -INT16_C(  8156),       INT16_MIN, -INT16_C(  5354),
         INT16_C( 25602), -INT16_C( 11444),  INT16_C( 20599),  INT16_C(  2566), -INT16_C(  1584), -INT16_C( 19486),  INT16_C(  1347), -INT16_C( 29638) } },
    { { UINT8_C(130), UINT8_C( 50), UINT8_C(  6), UINT8_C( 71), UINT8_C(249), UINT8_C(222), UINT8_C(171), UINT8_C( 81),
        UINT8_C(207), UINT8_C( 75), UINT8_C( 53), UINT8_C(100), UINT8_C(204), UINT8_C( 91), UINT8_C( 36), UINT8_C( 68),
        UINT8_C(120), UINT8_C(178), UINT8_C( 18), UINT8_C(182), UINT8_C( 33), UINT8_C(128), UINT8_C( 74), UINT8_C( 32),
        UINT8_C(100), UINT8_C(248), UINT8_C(  8), UINT8_C(161), UINT8_C(132), UINT8_C(230), UINT8_C( 49), UINT8_C(  6),
        UINT8_C( 24), UINT8_C( 55), UINT8_C( 77), UINT8_C( 18), UINT8_C( 21), UINT8_C(248), UINT8_C( 99), UINT8_C(229),
        UINT8_C( 68), UINT8_C(153), UINT8_C( 73), UINT8_C( 16), UINT8_C(244), UINT8_C(109), UINT8_C( 84), UINT8_C(109),
        UINT8_C( 31), UINT8_C(103), UINT8_C( 35), UINT8_C( 65), UINT8_C(231), UINT8_C(109), UINT8_C( 97), UINT8_C( 76),
        UINT8_C(101), UINT8_C(106), UINT8_C(237), UINT8_C(233), UINT8_C( 80), UINT8_C( 30), UINT8_C(239), UINT8_C(104) },
      {  INT8_C(  85),  INT8_C(  60),  INT8_C( 122),  INT8_C( 107),  INT8_C(  53), -INT8_C(  34),  INT8_C(  80),  INT8_C( 121),
         INT8_C( 119), -INT8_C( 103), -INT8_C( 119),  INT8_C( 107),  INT8_C(   6), -INT8_C(  34), -INT8_C(  40),  INT8_C(  37),
         INT8_C(  69), -INT8_C(   5),  INT8_C( 102),  INT8_C(  44),  INT8_C( 104), -INT8_C(  56),  INT8_C( 120), -INT8_C(  50),
         INT8_C(  50),  INT8_C( 101), -INT8_C(  73), -INT8_C( 126), -INT8_C( 125), -INT8_C(  89), -INT8_C(  22), -INT8_C(  39),
        -INT8_C(  29),  INT8_C( 101),  INT8_C(  68),  INT8_C(  24),  INT8_C(  67), -INT8_C( 108), -INT8_C( 111), -INT8_C(  70),
         INT8_C(  45),  INT8_C(  27),  INT8_C(  37),  INT8_C(  51), -INT8_C(   7), -INT8_C(   2),  INT8_C(  88),  INT8_C(  62),
        -INT8_C(   7), -INT8_C(  65),  INT8_C( 106),  INT8_C(  98), -INT8_C( 121), -INT8_C(  29),  INT8_C(  48), -INT8_C(  71),
         INT8_C(  72), -INT8_C(  25),  INT8_C(  59), -INT8_C(  52), -INT8_C( 114),  INT8_C(  37), -INT8_C(  91),  INT8_C( 114) },
      {  INT16_C( 14050),  INT16_C(  8329),  INT16_C(  5649),  INT16_C( 23481),  INT16_C( 16908),  INT16_C(  4393), -INT16_C(  1870),  INT16_C(  1076),
         INT16_C(  7390),  INT16_C(  9844), -INT16_C(  3736),  INT16_C(  7280),  INT16_C( 30048), -INT16_C( 20870),       INT16_MIN, -INT16_C(  1312),
         INT16_C(  4859),  INT16_C(  5668), -INT16_C( 25377), -INT16_C( 27019),  INT16_C(  7191),  INT16_C(  3517), -INT16_C(  1926),  INT16_C( 14150),
        -INT16_C(  6912),  INT16_C( 10080), -INT16_C( 31112), -INT16_C(   740),  INT16_C(  4622),  INT16_C(  1867), -INT16_C(  8010), -INT16_C(  9893) } },
    { { UINT8_C(138), UINT8_C(233), UINT8_C(138), UINT8_C(205), UINT8_C(125), UINT8_C( 28), UINT8_C(135), UINT8_C(170),
        UINT8_C( 55), UINT8_C(173), UINT8_C(221), UINT8_C( 48), UINT8_C(171), UINT8_C( 53), UINT8_C(110), UINT8_C(164),
        UINT8_C(244), UINT8_C(216), UINT8_C(  6), UINT8_C(123), UINT8_C(187), UINT8_C( 54), UINT8_C( 52), UINT8_C(  4),
        UINT8_C( 30), UINT8_C(111), UINT8_C(208), UINT8_C(172), UINT8_C(149), UINT8_C(117), UINT8_C( 30), UINT8_C( 31),
        UINT8_C( 94), UINT8_C(169), UINT8_C(237), UINT8_C(219), UINT8_C(197), UINT8_C(116), UINT8_C(133), UINT8_C(252),
        UINT8_C( 33), UINT8_C( 98), UINT8_C( 44), UINT8_C(204), UINT8_C(151), UINT8_C(154), UINT8_C(113), UINT8_C(140),
        UINT8_C(114), UINT8_C(119), UINT8_C(  7), UINT8_C( 46), UINT8_C(174), UINT8_C( 60), UINT8_C( 50), UINT8_C(204),
        UINT8_C(171), UINT8_C(  2), UINT8_C(120), UINT8_C( 64), UINT8_C(119), UINT8_C(151), UINT8_C( 96), UINT8_C(213) },
      {  INT8_C(  64),  INT8_C(  77), -INT8_C(  80),  INT8_C(   5), -INT8_C(  63),  INT8_C(  53),  INT8_C(   1), -INT8_C(  29),
        -INT8_C( 105),  INT8_C(  45), -INT8_C(  81),  INT8_C(  46), -INT8_C(  57),  INT8_C(  32), -INT8_C(  70),  INT8_C(  57),
        -INT8_C( 104), -INT8_C(  62),  INT8_C( 103),  INT8_C(  70), -INT8_C(   2), -INT8_C( 103),  INT8_C(  18), -INT8_C(  87),
        -INT8_C( 101), -INT8_C( 118), -INT8_C(  22),  INT8_C(  18),  INT8_C(  33),  INT8_C(  74), -INT8_C(  25),  INT8_C(  97),
        -INT8_C( 105), -INT8_C( 105),  INT8_C( 102),  INT8_C(  88), -INT8_C(  52),  INT8_C( 103),  INT8_C(  59),  INT8_C(  99),
        -INT8_C( 108), -INT8_C(  21), -INT8_C( 110),  INT8_C(  91),  INT8_C(  11),  INT8_C(  76), -INT8_C( 107), -INT8_C(  93),
         INT8_C(  14), -INT8_C(   4), -INT8_C(  23),  INT8_C(  12), -INT8_C( 106), -INT8_C(   5), -INT8_C(  74),  INT8_C(  49),
        -INT8_C( 122), -INT8_C(  96),  INT8_C(  68), -INT8_C(  89), -INT8_C(  22),  INT8_C(  43),  INT8_C(   9), -INT8_C( 127) },
      {  INT16_C( 26773), -INT16_C( 10015), -INT16_C(  6391), -INT16_C(  4795),  INT16_C(  2010), -INT16_C( 15693), -INT16_C(  8051),  INT16_C(  1648),
              INT16_MIN,  INT16_C(  9228), -INT16_C(  5936),  INT16_C(   588), -INT16_C( 16128), -INT16_C(  1480),  INT16_C( 13575),  INT16_C(  2257),
        -INT16_C( 27615),       INT16_MAX,  INT16_C(  1704),       INT16_MAX, -INT16_C(  5622),  INT16_C( 13724),  INT16_C( 13365), -INT16_C( 25111),
         INT16_C(  1120),  INT16_C(   391), -INT16_C( 18744),  INT16_C(  6296), -INT16_C( 21054),  INT16_C(  2464),  INT16_C(  3875), -INT16_C( 26187) } },
    { { UINT8_C(195), UINT8_C(111), UINT8_C(217), UINT8_C(143), UINT8_C(215), UINT8_C( 21), UINT8_C(243), UINT8_C(107),
        UINT8_C(  0), UINT8_C(133), UINT8_C(199), UINT8_C( 11), UINT8_C(209), UINT8_C( 92), UINT8_C(175), UINT8_C(224),
        UINT8_C( 88), UINT8_C(152), UINT8_C(236), UINT8_C(238), UINT8_C(148), UINT8_C(162), UINT8_C( 32), UINT8_C( 26),
        UINT8_C( 66), UINT8_C(100), UINT8_C(193), UINT8_C( 44), UINT8_C(143), UINT8_C(202), UINT8_C(173), UINT8_C( 82),
        UINT8_C( 58), UINT8_C(135), UINT8_C(226), UINT8_C( 17), UINT8_C(156), UINT8_C(213), UINT8_C(124), UINT8_C(156),
        UINT8_C( 90), UINT8_C( 67), UINT8_C(167), UINT8_C( 43), UINT8_C(159), UINT8_C( 86), UINT8_C( 11), UINT8_C(248),
        UINT8_C(239), UINT8_C(248), UINT8_C(230), UINT8_C(131), UINT8_C(154), UINT8_C(  6), UINT8_C(157), UINT8_C(221),
        UINT8_C(106), UINT8_C( 94), UINT8_C(  9), UINT8_C(250), UINT8_C( 41), UINT8_C(183), UINT8_C( 76), UINT8_C( 99) },
      {  INT8_C(  62),  INT8_C(  46),  INT8_C( 116), -INT8_C(  38),  INT8_C(   3), -INT8_C(  16),  INT8_C( 118),  INT8_C(  93),
         INT8_C(  52),  INT8_C(  29), -INT8_C( 119), -INT8_C(  45),  INT8_C( 116), -INT8_C( 108), -INT8_C(  53),  INT8_C(  99),
        -INT8_C( 116), -INT8_C(  78), -INT8_C(  26),  INT8_C(  39), -INT8_C(  72), -INT8_C( 125),  INT8_C(   4),  INT8_C(  35),
        -INT8_C(  31),  INT8_C(  13),  INT8_C(  29),  INT8_C(  10), -INT8_C(  60),  INT8_C( 105),  INT8_C( 109),  INT8_C(   2),
        -INT8_C( 104), -INT8_C(  31), -INT8_C(  36), -INT8_C( 101), -INT8_C(  46),  INT8_C(  82), -INT8_C(   7),  INT8_C(   6),
         INT8_C( 112), -INT8_C( 126), -INT8_C(  39), -INT8_C(  28),  INT8_C(  22), -INT8_C(  91),  INT8_C(  71), -INT8_C(  93),
         INT8_C(  87),  INT8_C(  45), -INT8_C(  54),  INT8_C(  15), -INT8_C(  80), -INT8_C(  50),  INT8_C(  50), -INT8_C( 111),
        -INT8_C(  37),  INT8_C(  79), -INT8_C( 100), -INT8_C(  96), -INT8_C(  71),  INT8_C(   9), -INT8_C(  94),  INT8_C(  81) },
      {  INT16_C( 17196),  INT16_C( 19738),  INT16_C(   309),       INT16_MAX,  INT16_C(  3857), -INT16_C( 24176),  INT16_C( 14308),  INT16_C( 12901),
        -INT16_C( 22064),  INT16_C(  3146), -INT16_C( 30906),  INT16_C(  1038), -INT16_C(   746),  INT16_C(  6037),  INT16_C( 12630),  INT16_C( 19021),
        -INT16_C( 10217), -INT16_C(  9853),  INT16_C( 10290),  INT16_C(    68),  INT16_C(  1638), -INT16_C(  7717), -INT16_C(  4328), -INT16_C( 22283),
         INT16_C( 31953), -INT16_C( 10455), -INT16_C( 12620), -INT16_C( 16681),  INT16_C(  3504), -INT16_C( 24900), -INT16_C(  1264),  INT16_C(   875) } },
    { { UINT8_C(235), UINT8_C(127), UINT8_C(236), UINT8_C(189), UINT8_C(209), UINT8_C(229), UINT8_C(195), UINT8_C( 65),
        UINT8_C(103), UINT8_C(156), UINT8_C( 37), UINT8_C(126), UINT8_C( 65), UINT8_C(108), UINT8_C( 33), UINT8_C(152),
        UINT8_C(153), UINT8_C(235), UINT8_C(168), UINT8_C( 73), UINT8_C(185), UINT8_C(218), UINT8_C(219), UINT8_C(148),
        UINT8_C( 42), UINT8_C(119), UINT8_C( 52), UINT8_C(227), UINT8_C(128), UINT8_C(215), UINT8_C( 52), UINT8_C(107),
        UINT8_C( 86), UINT8_C( 32), UINT8_C( 40), UINT8_C( 39), UINT8_C(  6), UINT8_C(235), UINT8_C(105), UINT8_C(109),
        UINT8_C(136), UINT8_C(142), UINT8_C(235), UINT8_C(201), UINT8_C(251), UINT8_C( 12), UINT8_C( 98), UINT8_C(148),
        UINT8_C(247), UINT8_C( 10), UINT8_C(222), UINT8_C(176), UINT8_C(228), UINT8_C(185), UINT8_C( 69), UINT8_C( 14),
        UINT8_C( 48), UINT8_C(121), UINT8_C(241), UINT8_C(176), UINT8_C( 80), UINT8_C( 37), UINT8_C( 28), UINT8_C(166) },
      {  INT8_C(  70),  INT8_C(  68), -INT8_C(  50),  INT8_C(  76),  INT8_C(  48),  INT8_C(  55), -INT8_C(  71), -INT8_C(  72),
        -INT8_C(  59), -INT8_C(  91), -INT8_C( 127), -INT8_C(  64), -INT8_C(  79), -INT8_C(  29),  INT8_C(  85), -INT8_C(  87),
        -INT8_C(  19),  INT8_C(  51),  INT8_C(  89), -INT8_C(  46), -INT8_C(  20), -INT8_C(  98), -INT8_C(  32),  INT8_C(  28),
         INT8_C(  24), -INT8_C(  46), -INT8_C(  52),  INT8_C( 104), -INT8_C(   9), -INT8_C(  24),  INT8_C(  15),  INT8_C(  61),
         INT8_C(  45), -INT8_C(  35), -INT8_C( 119),  INT8_C(  93),  INT8_C(  20),  INT8_C(  67),  INT8_C(  21), -INT8_C(  39),
        -INT8_C(  24), -INT8_C( 106), -INT8_C( 102), -INT8_C( 103),  INT8_C( 122), -INT8_C(  17),  INT8_C(  66),  INT8_C( 103),
         INT8_C(  34), -INT8_C( 100),  INT8_C(  57),  INT8_C(  14),  INT8_C(  58),  INT8_C(  26),  INT8_C(  42),  INT8_C(  82),
        -INT8_C(  20), -INT8_C(  10), -INT8_C(  69), -INT8_C(  29), -INT8_C(  33), -INT8_C(  54),  INT8_C(  33),  INT8_C(  12) },
      {  INT16_C( 25086),  INT16_C(  2564),  INT16_C( 22627), -INT16_C( 18525), -INT16_C( 20273), -INT16_C( 12763), -INT16_C(  8267), -INT16_C( 10419),
         INT16_C(  9078),  INT16_C( 11594), -INT16_C( 25064), -INT16_C(  2864), -INT16_C(  4466),  INT16_C( 20904), -INT16_C(  6312),  INT16_C(  7307),
         INT16_C(  2750), -INT16_C(  1133),  INT16_C( 15865), -INT16_C(  2046), -INT16_C( 18316),       INT16_MIN,  INT16_C( 30418),  INT16_C( 21712),
         INT16_C(  7398),  INT16_C( 15118),  INT16_C( 18034),  INT16_C(  4046), -INT16_C(  2170), -INT16_C( 21733), -INT16_C(  4638),  INT16_C(  2916) } },
    { { UINT8_C(167), UINT8_C(170), UINT8_C(105), UINT8_C(187), UINT8_C(237), UINT8_C(126), UINT8_C(148), UINT8_C(213),
        UINT8_C( 20), UINT8_C( 46), UINT8_C(111), UINT8_C(142), UINT8_C( 29), UINT8_C(177), UINT8_C(246), UINT8_C( 63),
        UINT8_C( 77), UINT8_C( 47), UINT8_C( 77), UINT8_C(136), UINT8_C( 73), UINT8_C(119), UINT8_C(218), UINT8_C( 53),
        UINT8_C(110), UINT8_C(149), UINT8_C( 25), UINT8_C( 77), UINT8_C( 95), UINT8_C( 58), UINT8_C( 89), UINT8_C(  6),
        UINT8_C(228), UINT8_C(194), UINT8_C(193), UINT8_C(210), UINT8_C( 64), UINT8_C( 86), UINT8_C(167), UINT8_C( 84),
        UINT8_C(132), UINT8_C( 22), UINT8_C(227), UINT8_C(162), UINT8_C(200), UINT8_C(217), UINT8_C(225), UINT8_C( 21),
        UINT8_C(  8), UINT8_C( 47), UINT8_C(157), UINT8_C( 82), UINT8_C(166), UINT8_C(120), UINT8_C(135), UINT8_C( 20),
        UINT8_C( 13), UINT8_C(160), UINT8_C( 97), UINT8_C(109), UINT8_C(218), UINT8_C(186), UINT8_C(115), UINT8_C(191) },
      {  INT8_C( 124),  INT8_C(  53), -INT8_C( 111), -INT8_C(  68), -INT8_C( 117),  INT8_C(  56),  INT8_C(  17),  INT8_C(  15),
         INT8_C(  79), -INT8_C(  12), -INT8_C(  79),  INT8_C(  23), -INT8_C(  51), -INT8_C( 109),  INT8_C(  44), -INT8_C(  43),
        -INT8_C(  62), -INT8_C(  54),  INT8_C(  39),  INT8_C( 104),  INT8_C(  66), -INT8_C(  81),  INT8_C( 125),  INT8_C(  79),
         INT8_C(  79), -INT8_C(  34), -INT8_C(  68),  INT8_C(  42), -INT8_C( 103),  INT8_C(  48), -INT8_C(  23),  INT8_C(  21),
         INT8_C( 101),  INT8_C( 122), -INT8_C(  46), -INT8_C(  16), -INT8_C(  78), -INT8_C(  29), -INT8_C(   1),  INT8_C(   1),
        -INT8_C(  41), -INT8_C(  79),  INT8_C(  24), -INT8_C(  92),  INT8_C(  68),  INT8_C(  69),  INT8_C( 121),  INT8_C(   6),
         INT8_C(  15), -INT8_C(  95),  INT8_C( 110),  INT8_C(  81),  INT8_C(  80), -INT8_C(  21), -INT8_C(  96), -INT8_C(  97),
        -INT8_C(  54),  INT8_C(  93), -INT8_C(  55),  INT8_C(  99), -INT8_C( 115), -INT8_C(  78),  INT8_C( 120), -INT8_C(  14) },
      {  INT16_C( 29718), -INT16_C( 24371), -INT16_C( 20673),  INT16_C(  5711),  INT16_C(  1028), -INT16_C(  5503), -INT16_C( 20772),  INT16_C(  8115),
        -INT16_C(  7312),  INT16_C( 17147), -INT16_C(  4821),  INT16_C( 31437),  INT16_C(  3624),  INT16_C(  1534), -INT16_C(  7001), -INT16_C(  1921),
              INT16_MAX, -INT16_C( 12238), -INT16_C(  7486), -INT16_C(    83), -INT16_C(  7150), -INT16_C(  9456),  INT16_C( 28573),  INT16_C( 27351),
        -INT16_C(  4345),  INT16_C( 23912),  INT16_C( 10760), -INT16_C( 14900),  INT16_C( 14178),  INT16_C(  5456),       INT16_MIN,  INT16_C( 11126) } },
    { { UINT8_C( 44), UINT8_C( 74), UINT8_C(226), UINT8_C(223), UINT8_C( 45), UINT8_C(225), UINT8_C(224), UINT8_C(  4),
        UINT8_C(146), UINT8_C(249), UINT8_C(168), UINT8_C(214), UINT8_C( 62), UINT8_C( 34), UINT8_C(220), UINT8_C( 77),
        UINT8_C(195), UINT8_C( 75), UINT8_C(158), UINT8_C( 19), UINT8_C( 54), UINT8_C( 62), UINT8_C(178), UINT8_C(  0),
        UINT8_C(155), UINT8_C(124), UINT8_C( 99), UINT8_C( 40), UINT8_C( 46), UINT8_C(220), UINT8_C( 26), UINT8_C( 91),
        UINT8_C( 38), UINT8_C(252), UINT8_C( 58), UINT8_C( 84), UINT8_C(222), UINT8_C( 26), UINT8_C( 88), UINT8_C(112),
        UINT8_C( 19), UINT8_C(  1), UINT8_C( 71), UINT8_C( 81), UINT8_C( 35), UINT8_C( 35), UINT8_C(158), UINT8_C(230),
        UINT8_C(110), UINT8_C( 60), UINT8_C(249), UINT8_C(165), UINT8_C(123), UINT8_C(171), UINT8_C(165), UINT8_C( 22),
        UINT8_C( 39), UINT8_C(  9), UINT8_C( 63), UINT8_C( 86), UINT8_C(229), UINT8_C( 89), UINT8_C(177), UINT8_C( 11) },
      {  INT8_C(  86), -INT8_C(  21),  INT8_C(  95),  INT8_C(  52),  INT8_C(   5), -INT8_C(  72), -INT8_C(  92),  INT8_C(  25),
        -INT8_C(  71), -INT8_C(  21),  INT8_C( 106), -INT8_C(  36),  INT8_C(  15),  INT8_C(   9), -INT8_C(  62),  INT8_C( 125),
         INT8_C(  69), -INT8_C(  69),  INT8_C(  34), -INT8_C(  64),  INT8_C( 102), -INT8_C(  56), -INT8_C(  41), -INT8_C( 114),
        -INT8_C(  47),  INT8_C(  22), -INT8_C(  28), -INT8_C(  74),  INT8_C( 111), -INT8_C( 107), -INT8_C(  63), -INT8_C(  59),
             INT8_MIN,  INT8_C(  33), -INT8_C(   7), -INT8_C( 123), -INT8_C(  39), -INT8_C(  98), -INT8_C(  98), -INT8_C( 110),
        -INT8_C( 119),  INT8_C(   9),  INT8_C( 110), -INT8_C( 104),  INT8_C(  18),  INT8_C(  48),  INT8_C(  22),  INT8_C(  87),
        -INT8_C(  21),  INT8_C(  56),  INT8_C(  24),  INT8_C(  81),  INT8_C(   0), -INT8_C(  17), -INT8_C(  33), -INT8_C(  47),
         INT8_C(   5), -INT8_C(  61), -INT8_C( 121),  INT8_C( 116),  INT8_C(  88),  INT8_C(  73),  INT8_C(  58), -INT8_C(  40) },
      {  INT16_C(  2230),       INT16_MAX, -INT16_C( 15975), -INT16_C( 20508), -INT16_C( 15595),  INT16_C( 10104),  INT16_C(  1236), -INT16_C(  4015),
         INT16_C(  8280),  INT16_C(  4156),  INT16_C(  2036), -INT16_C(  7298), -INT16_C(  4557), -INT16_C(  5732), -INT16_C( 18434), -INT16_C(  7007),
         INT16_C(  3452), -INT16_C( 10738), -INT16_C( 11206), -INT16_C( 20944), -INT16_C(  2252), -INT16_C(   614),  INT16_C(  2310),  INT16_C( 23486),
         INT16_C(  1050),  INT16_C( 19341), -INT16_C(  2907), -INT16_C(  6479), -INT16_C(   354),  INT16_C(  2353),  INT16_C( 26649),  INT16_C(  9826) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m512i a = simde_mm512_loadu_epi16(test_vec[i].a);
    simde__m512i b = simde_mm512_loadu_epi16(test_vec[i].b);
    simde__m512i r = simde_mm512_maddubs_epi16(a, b);
    simde_test_x86_assert_equal_i16x32(r, simde_mm512_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm512_mask_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const int16_t src[32];
    const simde__mmask32 k;
    const uint8_t a[64];
    const int8_t  b[64];
    const int16_t r[32];
  } test_vec[] = {
    { { -INT16_C(  6105),  INT16_C(  7482),  INT16_C( 26084), -INT16_C( 14197),  INT16_C( 11336),  INT16_C( 32328),  INT16_C(  6067),  INT16_C(  4069),
         INT16_C(  6871),  INT16_C( 28055),  INT16_C( 25090), -INT16_C( 11789), -INT16_C( 18199), -INT16_C( 18161),  INT16_C( 19220),  INT16_C( 15425),
         INT16_C( 31795),  INT16_C(  6233), -INT16_C(  6943),  INT16_C( 10720),  INT16_C( 10513), -INT16_C( 15193), -INT16_C( 29632),  INT16_C(  6099),
         INT16_C( 27302), -INT16_C( 22140),  INT16_C( 30669), -INT16_C( 18822), -INT16_C( 30161),  INT16_C( 17520), -INT16_C( 20011),  INT16_C(  2176) },
      UINT32_C( 237033773),
      { UINT8_C(190), UINT8_C(  1), UINT8_C( 55), UINT8_C(207), UINT8_C( 42), UINT8_C(222), UINT8_C(147), UINT8_C(106),
        UINT8_C(106), UINT8_C(103), UINT8_C(129), UINT8_C( 17), UINT8_C(209), UINT8_C(  5), UINT8_C(186), UINT8_C(158),
        UINT8_C(124), UINT8_C( 52), UINT8_C( 85), UINT8_C(171), UINT8_C(190), UINT8_C(197), UINT8_C(239), UINT8_C(147),
        UINT8_C(118), UINT8_C(111), UINT8_C(156), UINT8_C(164), UINT8_C( 73), UINT8_C(188), UINT8_C(178), UINT8_C(  7),
        UINT8_C(189), UINT8_C(234), UINT8_C(214), UINT8_C(231), UINT8_C(200), UINT8_C(105), UINT8_C( 81), UINT8_C( 51),
        UINT8_C(208), UINT8_C(210), UINT8_C( 68), UINT8_C(162), UINT8_C(215), UINT8_C(254), UINT8_C( 64), UINT8_C( 83),
        UINT8_C( 50), UINT8_C(149),    UINT8_MAX, UINT8_C(241), UINT8_C( 90), UINT8_C(238), UINT8_C(132), UINT8_C(209),
        UINT8_C( 94), UINT8_C( 32), UINT8_C(117), UINT8_C(167), UINT8_C(221), UINT8_C( 39), UINT8_C(174), UINT8_C(154) },
      {  INT8_C(  17), -INT8_C( 124), -INT8_C( 126), -INT8_C(  38), -INT8_C(  19), -INT8_C(  45),  INT8_C(  13), -INT8_C(  66),
        -INT8_C(  90),  INT8_C(  81),  INT8_C(  96),  INT8_C( 125),  INT8_C(  79), -INT8_C(  96), -INT8_C(  47), -INT8_C( 127),
         INT8_C(  54), -INT8_C(  48),  INT8_C( 114), -INT8_C( 112), -INT8_C(  66), -INT8_C(   9),  INT8_C(  97),  INT8_C(  28),
         INT8_C(  23), -INT8_C(  42), -INT8_C(  61), -INT8_C(  12), -INT8_C(   2),  INT8_C( 113), -INT8_C( 113),  INT8_C(  15),
        -INT8_C(  11),  INT8_C(  17), -INT8_C(  23), -INT8_C(  29), -INT8_C(  28), -INT8_C(  10), -INT8_C(  95), -INT8_C( 118),
         INT8_C(  71),  INT8_C(   1),  INT8_C(   8), -INT8_C( 106), -INT8_C(  95), -INT8_C(  39),  INT8_C(  24), -INT8_C(  41),
        -INT8_C(  87), -INT8_C( 118),  INT8_C( 104),  INT8_C( 103), -INT8_C( 127), -INT8_C(  55), -INT8_C( 124), -INT8_C( 103),
        -INT8_C(  96),  INT8_C(  71), -INT8_C( 115), -INT8_C(  98), -INT8_C(  71),  INT8_C(  28), -INT8_C(  83), -INT8_C(  82) },
      {  INT16_C(  3106),  INT16_C(  7482), -INT16_C( 10788), -INT16_C(  5085),  INT16_C( 11336),  INT16_C( 14509),  INT16_C(  6067),  INT16_C(  4069),
         INT16_C(  4200),  INT16_C( 28055),  INT16_C( 25090),  INT16_C( 27299), -INT16_C(  1948), -INT16_C( 18161),  INT16_C( 21098), -INT16_C( 20009),
         INT16_C( 31795),  INT16_C(  6233), -INT16_C(  6943),  INT16_C( 10720),  INT16_C( 10513), -INT16_C( 16628), -INT16_C( 29632),  INT16_C(  6099),
         INT16_C( 27302),       INT16_MAX, -INT16_C( 24520),       INT16_MIN, -INT16_C( 30161),  INT16_C( 17520), -INT16_C( 20011),  INT16_C(  2176) } },
    { { -INT16_C( 26835),  INT16_C(  4753),  INT16_C( 12941), -INT16_C( 10852), -INT16_C( 23501), -INT16_C( 10901), -INT16_C( 31875),  INT16_C(  9900),
         INT16_C(  5134), -INT16_C( 28786),  INT16_C(  4830),  INT16_C( 32296), -INT16_C( 18855),  INT16_C(  4636), -INT16_C( 13870),  INT16_C(   193),
         INT16_C( 21088), -INT16_C(  4590), -INT16_C( 20859), -INT16_C( 18237),  INT16_C( 11859), -INT16_C( 12147),  INT16_C( 15026), -INT16_C( 16137),
        -INT16_C( 31410),  INT16_C( 11343),  INT16_C( 30871), -INT16_C(  3926), -INT16_C( 14802),  INT16_C(     3), -INT16_C( 15216), -INT16_C(  4096) },
      UINT32_C(2615022102),
      { UINT8_C(193), UINT8_C(161), UINT8_C( 84), UINT8_C( 20), UINT8_C(208), UINT8_C(225), UINT8_C(228), UINT8_C(130),
        UINT8_C( 27), UINT8_C(219), UINT8_C( 66), UINT8_C(106), UINT8_C( 96), UINT8_C(145), UINT8_C(150), UINT8_C(247),
        UINT8_C(  9), UINT8_C( 65), UINT8_C(232), UINT8_C( 55), UINT8_C(  7), UINT8_C(235), UINT8_C( 56), UINT8_C(151),
        UINT8_C(175), UINT8_C( 56), UINT8_C(136), UINT8_C(197), UINT8_C( 75), UINT8_C(102), UINT8_C( 97), UINT8_C( 12),
        UINT8_C(  8), UINT8_C(181), UINT8_C( 32), UINT8_C(216), UINT8_C(150), UINT8_C(  4), UINT8_C( 90), UINT8_C(178),
        UINT8_C(224), UINT8_C(156), UINT8_C( 28), UINT8_C( 64), UINT8_C( 45), UINT8_C(178), UINT8_C( 56), UINT8_C( 55),
        UINT8_C(243), UINT8_C( 32), UINT8_C(110), UINT8_C(251), UINT8_C( 11), UINT8_C(166), UINT8_C(146), UINT8_C(186),
        UINT8_C(223), UINT8_C( 26), UINT8_C(127), UINT8_C( 42), UINT8_C(129), UINT8_C(224), UINT8_C( 54), UINT8_C(137) },
      { -INT8_C( 107),  INT8_C(  86),  INT8_C(  97),  INT8_C(  44),  INT8_C(  90), -INT8_C(  69), -INT8_C(  34),  INT8_C(  58),
         INT8_C(  87), -INT8_C(   6),  INT8_C( 123), -INT8_C( 124), -INT8_C(  84), -INT8_C(  77), -INT8_C(  69), -INT8_C(  96),
        -INT8_C(  45),  INT8_C(  42), -INT8_C( 101), -INT8_C(  34), -INT8_C(  48),  INT8_C(  45), -INT8_C( 104), -INT8_C(  81),
         INT8_C(  72),  INT8_C(  23), -INT8_C(  39), -INT8_C(  55), -INT8_C(   8),  INT8_C(  15),  INT8_C(  82), -INT8_C( 115),
         INT8_C( 101), -INT8_C(  77), -INT8_C(  71), -INT8_C(  64),  INT8_C( 110), -INT8_C( 105), -INT8_C(   6), -INT8_C(  59),
        -INT8_C( 111),  INT8_C( 117),  INT8_C(  73),  INT8_C(  62),  INT8_C(  40),  INT8_C(   5), -INT8_C(  34), -INT8_C(   5),
         INT8_C(  47),  INT8_C( 121), -INT8_C(  39), -INT8_C(   1), -INT8_C(  90),  INT8_C( 113), -INT8_C(  81), -INT8_C(  18),
        -INT8_C( 119), -INT8_C( 120), -INT8_C(  73), -INT8_C( 127), -INT8_C( 104),  INT8_C(   9),  INT8_C(  14), -INT8_C(   3) },
      { -INT16_C( 26835),  INT16_C(  9028),  INT16_C(  3195), -INT16_C( 10852),  INT16_C(  1035), -INT16_C( 10901), -INT16_C( 31875),  INT16_C(  9900),
         INT16_C(  5134), -INT16_C( 25302),  INT16_C(  4830),  INT16_C( 32296),  INT16_C( 13888),  INT16_C(  4636), -INT16_C( 13870),  INT16_C(   193),
         INT16_C( 21088), -INT16_C( 16096),  INT16_C( 16080), -INT16_C( 11042), -INT16_C(  6612), -INT16_C( 12147),  INT16_C(  2690), -INT16_C(  2179),
         INT16_C( 15293), -INT16_C(  4541),  INT16_C( 30871), -INT16_C( 15174), -INT16_C( 29657),  INT16_C(     3), -INT16_C( 15216),  INT16_C(   345) } },
    { { -INT16_C( 14148),  INT16_C( 10941), -INT16_C( 18337), -INT16_C(  3601),  INT16_C( 14637),  INT16_C( 22063),  INT16_C(  3390),  INT16_C( 27985),
         INT16_C( 11142),  INT16_C( 11372),  INT16_C(  7068),  INT16_C(  9499), -INT16_C( 11612),  INT16_C( 15526), -INT16_C( 18980), -INT16_C( 26567),
        -INT16_C(  2179), -INT16_C(  9021), -INT16_C( 19793), -INT16_C(  9011), -INT16_C(   789),  INT16_C( 10546), -INT16_C( 31735), -INT16_C( 28778),
         INT16_C(   943),  INT16_C( 19388), -INT16_C( 10466), -INT16_C( 15759),  INT16_C(  6057), -INT16_C( 31234),  INT16_C( 14540),  INT16_C( 18718) },
      UINT32_C(3727089967),
      { UINT8_C(147), UINT8_C(243), UINT8_C(186), UINT8_C(127), UINT8_C(240), UINT8_C(237), UINT8_C(168), UINT8_C(249),
        UINT8_C(113), UINT8_C( 63), UINT8_C(137), UINT8_C( 32), UINT8_C( 66), UINT8_C( 69), UINT8_C(107), UINT8_C( 96),
        UINT8_C( 28), UINT8_C(220), UINT8_C( 35), UINT8_C(197), UINT8_C(244), UINT8_C( 33), UINT8_C( 75), UINT8_C(192),
        UINT8_C( 89), UINT8_C(105), UINT8_C( 10), UINT8_C(136), UINT8_C( 74), UINT8_C( 48), UINT8_C(102), UINT8_C(221),
        UINT8_C( 35), UINT8_C( 33), UINT8_C( 92), UINT8_C( 19), UINT8_C( 14), UINT8_C(  5), UINT8_C( 13), UINT8_C(127),
        UINT8_C( 68), UINT8_C(150), UINT8_C(159), UINT8_C(134), UINT8_C(219), UINT8_C( 10), UINT8_C(230), UINT8_C(247),
        UINT8_C(231), UINT8_C(  9), UINT8_C(188), UINT8_C(219), UINT8_C( 43), UINT8_C(  7), UINT8_C(155), UINT8_C(132),
        UINT8_C(112), UINT8_C(165), UINT8_C( 13), UINT8_C(186), UINT8_C(213), UINT8_C(115), UINT8_C(152), UINT8_C(249) },
      { -INT8_C( 108), -INT8_C(  12),  INT8_C(  12), -INT8_C(  94), -INT8_C(   7),  INT8_C(  25),  INT8_C(  33),  INT8_C(  61),
        -INT8_C(  81), -INT8_C(  64), -INT8_C(  61), -INT8_C( 118), -INT8_C(  53), -INT8_C(  86), -INT8_C( 127), -INT8_C(  78),
        -INT8_C(  77),  INT8_C(  62), -INT8_C( 115), -INT8_C(  34),  INT8_C(  69),  INT8_C(  40),  INT8_C(  99), -INT8_C(  74),
        -INT8_C(  50),  INT8_C( 112),  INT8_C( 112), -INT8_C(  93), -INT8_C(  29),  INT8_C(   8), -INT8_C( 100),  INT8_C( 120),
        -INT8_C(   3), -INT8_C(  87),  INT8_C(  26), -INT8_C(  10), -INT8_C(  62),  INT8_C(  60),  INT8_C(  52),  INT8_C( 114),
        -INT8_C(   4), -INT8_C(   9), -INT8_C(   4), -INT8_C(  57), -INT8_C(  95),  INT8_C( 126),  INT8_C( 121),  INT8_C(  85),
        -INT8_C(  68),  INT8_C(   6),  INT8_C(  51),  INT8_C(   1),  INT8_C(  47), -INT8_C( 106), -INT8_C(  73), -INT8_C(   3),
         INT8_C(   6),  INT8_C(  40), -INT8_C(  96), -INT8_C(  22),  INT8_C(  48),  INT8_C(  61),  INT8_C(  98),  INT8_C(  45) },
      { -INT16_C( 18792), -INT16_C(  9706),  INT16_C(  4245),  INT16_C( 20733),  INT16_C( 14637), -INT16_C( 12133),  INT16_C(  3390),  INT16_C( 27985),
         INT16_C( 11484),  INT16_C( 11372),  INT16_C(  7068),  INT16_C(  9499), -INT16_C( 11612), -INT16_C( 11528), -INT16_C(  1762),  INT16_C( 16320),
        -INT16_C(  2179),  INT16_C(  2202), -INT16_C(   568), -INT16_C(  9011), -INT16_C(   789), -INT16_C(  8274), -INT16_C( 31735), -INT16_C( 28778),
         INT16_C(   943),  INT16_C(  9807),  INT16_C(  1279), -INT16_C( 11711),  INT16_C(  7272), -INT16_C( 31234),  INT16_C( 17239),  INT16_C( 26101) } },
    { {  INT16_C( 31974), -INT16_C( 22492),  INT16_C( 22712), -INT16_C( 19174),  INT16_C(  5967), -INT16_C(  3716), -INT16_C(  2411),  INT16_C( 20806),
         INT16_C( 31228),  INT16_C( 11090),  INT16_C(  2576),  INT16_C(  5672), -INT16_C( 14030),  INT16_C( 25088),  INT16_C( 25094), -INT16_C(  4976),
        -INT16_C( 19233), -INT16_C( 26732), -INT16_C( 20724),  INT16_C( 23372), -INT16_C( 13882),  INT16_C( 23372), -INT16_C( 27969), -INT16_C( 17492),
        -INT16_C(   500),  INT16_C(  7399),  INT16_C(  3848),  INT16_C( 14898),  INT16_C( 13272), -INT16_C(  8547),  INT16_C( 11669),  INT16_C( 29898) },
      UINT32_C(3977011169),
      { UINT8_C( 14), UINT8_C( 88), UINT8_C( 72), UINT8_C(212), UINT8_C( 33), UINT8_C(149), UINT8_C( 47), UINT8_C(224),
        UINT8_C( 39), UINT8_C(219), UINT8_C(156), UINT8_C( 51), UINT8_C(217), UINT8_C(131), UINT8_C( 79), UINT8_C(226),
        UINT8_C(146), UINT8_C(130), UINT8_C( 28), UINT8_C(107), UINT8_C(181), UINT8_C(185), UINT8_C( 73), UINT8_C( 74),
        UINT8_C(230), UINT8_C( 20), UINT8_C(191), UINT8_C(199), UINT8_C(115), UINT8_C(203), UINT8_C(180), UINT8_C(129),
        UINT8_C( 35), UINT8_C(253), UINT8_C( 85), UINT8_C( 69), UINT8_C(146), UINT8_C(132), UINT8_C( 37), UINT8_C(185),
        UINT8_C( 95), UINT8_C(193), UINT8_C(237), UINT8_C( 56), UINT8_C( 68), UINT8_C( 60), UINT8_C( 26), UINT8_C(215),
        UINT8_C(190), UINT8_C( 55), UINT8_C( 66), UINT8_C(115), UINT8_C(240), UINT8_C(139), UINT8_C(190), UINT8_C(215),
        UINT8_C(159), UINT8_C(125), UINT8_C(158), UINT8_C( 18), UINT8_C( 72), UINT8_C( 83), UINT8_C(147), UINT8_C(107) },
      {  INT8_C(  80), -INT8_C(  24), -INT8_C(  80), -INT8_C(  30),  INT8_C( 108), -INT8_C(  42), -INT8_C( 101), -INT8_C(  53),
        -INT8_C( 105), -INT8_C( 120),  INT8_C(   4), -INT8_C(  36), -INT8_C(  59),  INT8_C(  30), -INT8_C(  77), -INT8_C( 125),
         INT8_C(  85), -INT8_C(  11), -INT8_C(   9),  INT8_C(  70),      INT8_MIN, -INT8_C(  75),  INT8_C(  29),  INT8_C(  32),
         INT8_C(  50), -INT8_C(  69),  INT8_C(  50),  INT8_C( 122),  INT8_C(  14), -INT8_C(  58), -INT8_C(  27),  INT8_C(  94),
        -INT8_C(  82), -INT8_C( 106),  INT8_C(  64),  INT8_C(  27),  INT8_C( 108), -INT8_C(  36), -INT8_C(  26),  INT8_C(   3),
         INT8_C( 100), -INT8_C(  22), -INT8_C(  33),  INT8_C(  41),  INT8_C(   9), -INT8_C( 110), -INT8_C(  83),  INT8_C(  94),
        -INT8_C( 121), -INT8_C(  92), -INT8_C(  92),  INT8_C(   8),  INT8_C(  89), -INT8_C(  63),  INT8_C(  40), -INT8_C( 117),
         INT8_C( 125),  INT8_C(  90),  INT8_C(   5), -INT8_C( 117),  INT8_C(  32), -INT8_C(  22), -INT8_C(  22), -INT8_C(  49) },
      { -INT16_C(   992), -INT16_C( 22492),  INT16_C( 22712), -INT16_C( 19174),  INT16_C(  5967), -INT16_C(  1212), -INT16_C(  8873),       INT16_MIN,
         INT16_C( 10980),  INT16_C(  7238),       INT16_MIN,  INT16_C(  4485),  INT16_C( 10120),  INT16_C( 25088), -INT16_C( 10164), -INT16_C(  4976),
        -INT16_C( 19233), -INT16_C( 26732),  INT16_C( 11016), -INT16_C(   407), -INT16_C( 13882),  INT16_C( 23372), -INT16_C( 27969), -INT16_C( 17492),
        -INT16_C( 28050),  INT16_C(  7399),  INT16_C( 12603), -INT16_C( 17555),  INT16_C( 13272), -INT16_C(  1316),  INT16_C(   478), -INT16_C(  8477) } },
    { {  INT16_C( 10880), -INT16_C(  4886), -INT16_C( 12282),  INT16_C( 27632), -INT16_C( 12357), -INT16_C( 15212),  INT16_C( 16738), -INT16_C(  5854),
        -INT16_C( 14363),  INT16_C( 16113),  INT16_C(  6536),  INT16_C(  1481), -INT16_C( 12684), -INT16_C( 27503),  INT16_C( 31673),  INT16_C( 14691),
         INT16_C( 19877), -INT16_C( 21466),  INT16_C(  5662), -INT16_C(  9961), -INT16_C( 21531),  INT16_C( 18333), -INT16_C( 16403), -INT16_C( 11727),
         INT16_C(  8838),  INT16_C(  3857), -INT16_C(  9668), -INT16_C( 20460), -INT16_C( 23127),  INT16_C( 25156), -INT16_C( 22496), -INT16_C( 14693) },
      UINT32_C( 326287861),
      { UINT8_C(215), UINT8_C(137), UINT8_C(236), UINT8_C(189), UINT8_C( 52), UINT8_C(137), UINT8_C(  4), UINT8_C( 33),
        UINT8_C( 73), UINT8_C( 53), UINT8_C(244), UINT8_C(207), UINT8_C( 88), UINT8_C(  5), UINT8_C(222), UINT8_C(148),
        UINT8_C(223), UINT8_C(243), UINT8_C( 68), UINT8_C(136), UINT8_C(152), UINT8_C(136), UINT8_C(234), UINT8_C(185),
        UINT8_C( 48), UINT8_C(134), UINT8_C(127), UINT8_C( 38), UINT8_C( 71), UINT8_C(241), UINT8_C( 57), UINT8_C( 31),
        UINT8_C(122), UINT8_C( 38), UINT8_C(220), UINT8_C(174), UINT8_C(175), UINT8_C(224), UINT8_C(208), UINT8_C(248),
        UINT8_C( 22), UINT8_C(196), UINT8_C(200), UINT8_C(110), UINT8_C(201), UINT8_C(166), UINT8_C(  2), UINT8_C(168),
        UINT8_C(153), UINT8_C( 70), UINT8_C( 49), UINT8_C( 50), UINT8_C(206), UINT8_C( 27), UINT8_C(235),    UINT8_MAX,
        UINT8_C(161), UINT8_C(106), UINT8_C( 37), UINT8_C(233), UINT8_C( 91), UINT8_C( 94), UINT8_C(  8), UINT8_C(213) },
      { -INT8_C( 124), -INT8_C(  28), -INT8_C( 125),  INT8_C(  52), -INT8_C(  60),  INT8_C(  83),  INT8_C(  44), -INT8_C(  38),
         INT8_C(  23), -INT8_C(  12),  INT8_C(  72), -INT8_C(  32), -INT8_C( 101),  INT8_C(  74), -INT8_C( 119),  INT8_C(  52),
        -INT8_C( 112), -INT8_C(  70),  INT8_C( 102),  INT8_C(  95), -INT8_C(  43),  INT8_C(  81),  INT8_C(  94),  INT8_C( 119),
        -INT8_C(  69), -INT8_C( 125),  INT8_C(  96),  INT8_C(  22), -INT8_C(  31),  INT8_C( 104), -INT8_C(  21),  INT8_C( 102),
         INT8_C(  76),  INT8_C( 111), -INT8_C( 102),  INT8_C(  16), -INT8_C(  62), -INT8_C(  58), -INT8_C(  21), -INT8_C(  38),
        -INT8_C(  69),  INT8_C(  51), -INT8_C(  70),  INT8_C(  86),  INT8_C( 126),  INT8_C(  67), -INT8_C( 118),  INT8_C(  14),
        -INT8_C(   3), -INT8_C(  15),  INT8_C( 109), -INT8_C(  45),  INT8_C(  66), -INT8_C(  53),  INT8_C(  74), -INT8_C(   2),
         INT8_C(  78), -INT8_C(  86),  INT8_C(  20),  INT8_C(  48),  INT8_C(  18),  INT8_C(   0), -INT8_C( 106),  INT8_C(  94) },
      { -INT16_C( 30496), -INT16_C(  4886),  INT16_C(  8251),  INT16_C( 27632),  INT16_C(  1043),  INT16_C( 10944), -INT16_C(  8518), -INT16_C( 18722),
              INT16_MIN,  INT16_C( 16113),  INT16_C(  6536),  INT16_C(  1481), -INT16_C( 12684), -INT16_C( 27503),  INT16_C( 22863),  INT16_C(  1965),
         INT16_C( 19877), -INT16_C( 19656),  INT16_C(  5662), -INT16_C(  9961),  INT16_C(  8478), -INT16_C(  4540),       INT16_MAX, -INT16_C( 11727),
        -INT16_C(  1509),  INT16_C(  3091), -INT16_C(  9668), -INT16_C( 20460),  INT16_C(  3442),  INT16_C( 25156), -INT16_C( 22496), -INT16_C( 14693) } },
    { {  INT16_C( 12399),  INT16_C( 12654),  INT16_C( 23030), -INT16_C( 20213), -INT16_C( 14707),  INT16_C(  2823), -INT16_C( 28151),  INT16_C(  1817),
        -INT16_C( 30845), -INT16_C( 14886),  INT16_C(  9298), -INT16_C( 24125), -INT16_C( 10034), -INT16_C(  7983),  INT16_C( 26584),  INT16_C( 18238),
        -INT16_C( 21353), -INT16_C( 29320), -INT16_C( 31738), -INT16_C( 27841),  INT16_C( 17994),  INT16_C( 21406), -INT16_C( 18472),  INT16_C( 23386),
         INT16_C( 13374), -INT16_C( 28383), -INT16_C(  7080),  INT16_C(  9778),  INT16_C(   956), -INT16_C( 27642),  INT16_C( 17514),  INT16_C(   475) },
      UINT32_C(4153300209),
      { UINT8_C(216), UINT8_C(205), UINT8_C(138), UINT8_C( 34), UINT8_C( 20), UINT8_C( 40), UINT8_C(117), UINT8_C(236),
        UINT8_C(223), UINT8_C(208), UINT8_C( 72), UINT8_C( 30), UINT8_C(  4), UINT8_C(105), UINT8_C(175), UINT8_C( 93),
        UINT8_C( 77), UINT8_C(225), UINT8_C(131), UINT8_C( 10), UINT8_C(228), UINT8_C(138), UINT8_C(158), UINT8_C( 78),
        UINT8_C(206), UINT8_C(122), UINT8_C( 79), UINT8_C(191), UINT8_C(206), UINT8_C(221), UINT8_C(182), UINT8_C(166),
        UINT8_C(171), UINT8_C( 64), UINT8_C(200), UINT8_C(191), UINT8_C(104), UINT8_C( 61), UINT8_C(171), UINT8_C( 72),
        UINT8_C( 13), UINT8_C(243), UINT8_C(102), UINT8_C( 18), UINT8_C( 92), UINT8_C( 21), UINT8_C(111), UINT8_C(170),
        UINT8_C(246), UINT8_C(242), UINT8_C(180), UINT8_C(218), UINT8_C(124), UINT8_C( 82), UINT8_C( 40), UINT8_C( 75),
        UINT8_C(204), UINT8_C(119), UINT8_C( 10), UINT8_C(154), UINT8_C( 84), UINT8_C(193), UINT8_C( 64),    UINT8_MAX },
      {  INT8_C(   1),  INT8_C(   8), -INT8_C(  66),  INT8_C( 106),  INT8_C(  70),  INT8_C( 106), -INT8_C(  78),  INT8_C(  83),
         INT8_C(  93),  INT8_C(  24),  INT8_C( 101), -INT8_C(  70),  INT8_C(  45), -INT8_C(  44),  INT8_C( 100),  INT8_C(  35),
        -INT8_C(  57),  INT8_C(  24), -INT8_C(   3),  INT8_C(  67),  INT8_C( 106),  INT8_C(  37), -INT8_C( 114),  INT8_C(  55),
        -INT8_C( 100), -INT8_C( 103), -INT8_C(  47), -INT8_C(  16),  INT8_C(  90),  INT8_C(  18), -INT8_C(  16),  INT8_C(  91),
         INT8_C(  26), -INT8_C(  82), -INT8_C(  59),  INT8_C(  96),  INT8_C(  24),  INT8_C( 119), -INT8_C(  76),  INT8_C( 118),
        -INT8_C( 113),  INT8_C(  25),  INT8_C(  48), -INT8_C(  68), -INT8_C(  18), -INT8_C( 108), -INT8_C(  33), -INT8_C(  75),
        -INT8_C(  84), -INT8_C(  36), -INT8_C(   8),  INT8_C(  22),  INT8_C(   1), -INT8_C( 121),  INT8_C(  77), -INT8_C(  99),
         INT8_C(  32),  INT8_C(  31), -INT8_C( 114),  INT8_C( 122),  INT8_C(  49),  INT8_C( 126), -INT8_C(  43),  INT8_C(  75) },
      {  INT16_C(  1856),  INT16_C( 12654),  INT16_C( 23030), -INT16_C( 20213),  INT16_C( 25731),  INT16_C(  5172), -INT16_C(  4440),  INT16_C( 20755),
        -INT16_C( 30845), -INT16_C( 14886),  INT16_C( 29274), -INT16_C( 24125),       INT16_MIN, -INT16_C(  7983),  INT16_C( 22518),  INT16_C( 18238),
        -INT16_C( 21353),  INT16_C(  6536),  INT16_C(  9755), -INT16_C(  4500),  INT16_C( 17994),  INT16_C( 21406), -INT16_C( 18472), -INT16_C( 16413),
        -INT16_C( 29376),  INT16_C(  3356), -INT16_C(  9798),  INT16_C(  9778),  INT16_C( 10217),  INT16_C( 17648),  INT16_C( 28434),  INT16_C( 16373) } },
    { { -INT16_C( 25812),  INT16_C( 17836),  INT16_C( 24594), -INT16_C( 23877), -INT16_C(  5255),  INT16_C( 26462),  INT16_C( 15999),  INT16_C( 11036),
         INT16_C(  5402),  INT16_C(  7233), -INT16_C( 28772), -INT16_C( 17223),  INT16_C( 18350), -INT16_C(  8394),  INT16_C(  3013), -INT16_C(  3542),
        -INT16_C( 10586), -INT16_C( 18121), -INT16_C(  3530), -INT16_C( 20389), -INT16_C( 17955),  INT16_C( 23575),  INT16_C( 13559),  INT16_C(  4743),
        -INT16_C( 14263), -INT16_C(  6866), -INT16_C(  6313),  INT16_C(  1441), -INT16_C( 10449), -INT16_C(  2844),  INT16_C(  4066), -INT16_C( 30234) },
      UINT32_C( 474095077),
      { UINT8_C( 15), UINT8_C(157), UINT8_C(204), UINT8_C(236), UINT8_C( 86), UINT8_C(227), UINT8_C( 72), UINT8_C( 78),
        UINT8_C( 23), UINT8_C(207), UINT8_C( 96), UINT8_C( 96), UINT8_C(152), UINT8_C(142), UINT8_C( 69), UINT8_C(239),
        UINT8_C(117), UINT8_C(230), UINT8_C(245), UINT8_C(164), UINT8_C(189), UINT8_C(217), UINT8_C(153), UINT8_C(160),
        UINT8_C(232), UINT8_C(127), UINT8_C( 41), UINT8_C(206), UINT8_C(157), UINT8_C(107), UINT8_C(234), UINT8_C(172),
        UINT8_C(  8), UINT8_C(182), UINT8_C(153), UINT8_C( 94), UINT8_C(153), UINT8_C(225), UINT8_C(172), UINT8_C(177),
        UINT8_C(177), UINT8_C( 12), UINT8_C( 17), UINT8_C( 73), UINT8_C(154), UINT8_C( 87), UINT8_C( 56), UINT8_C( 16),
        UINT8_C( 61), UINT8_C( 45), UINT8_C(180), UINT8_C(251), UINT8_C(  7), UINT8_C( 77), UINT8_C(155), UINT8_C(239),
        UINT8_C(205), UINT8_C(196), UINT8_C(189), UINT8_C(106), UINT8_C( 47), UINT8_C(167), UINT8_C( 22), UINT8_C( 55) },
      {  INT8_C(  93), -INT8_C(  81), -INT8_C( 107), -INT8_C(   9), -INT8_C( 111),  INT8_C(  66), -INT8_C(  88),  INT8_C(  66),
         INT8_C(  78), -INT8_C(  71), -INT8_C( 117), -INT8_C(  23),  INT8_C(  16), -INT8_C(  61), -INT8_C(   7),  INT8_C(  78),
        -INT8_C(  15), -INT8_C(  83),  INT8_C(  73), -INT8_C(   8), -INT8_C(   5), -INT8_C(  28), -INT8_C(  25), -INT8_C(  56),
        -INT8_C(  88), -INT8_C(  91),  INT8_C(  50), -INT8_C(  41),  INT8_C(  76),  INT8_C(  72),  INT8_C(  14), -INT8_C(  86),
        -INT8_C(   8), -INT8_C(  93), -INT8_C(  95), -INT8_C( 119), -INT8_C(  27),  INT8_C(  73), -INT8_C(  53),  INT8_C(  52),
         INT8_C(   2),  INT8_C(  86),  INT8_C(  29),  INT8_C(  19),  INT8_C(  25),  INT8_C(  22),  INT8_C(  97),  INT8_C(  10),
        -INT8_C(  61), -INT8_C(  86),  INT8_C(   2), -INT8_C(  66), -INT8_C( 114), -INT8_C(  22), -INT8_C( 122),  INT8_C(  54),
        -INT8_C( 113), -INT8_C(  72),  INT8_C(  13), -INT8_C(  37),  INT8_C(   1),  INT8_C(  27), -INT8_C( 123), -INT8_C(   7) },
      { -INT16_C( 11322),  INT16_C( 17836),  INT16_C(  5436), -INT16_C( 23877), -INT16_C(  5255), -INT16_C( 13440), -INT16_C(  6230),  INT16_C( 18159),
        -INT16_C( 20845),  INT16_C(  7233), -INT16_C(  7021), -INT16_C( 12785), -INT16_C( 31973), -INT16_C(  8394),  INT16_C(  3013), -INT16_C(  3542),
        -INT16_C( 10586), -INT16_C( 25721), -INT16_C(  3530), -INT16_C( 20389), -INT16_C( 17955),  INT16_C( 23575),  INT16_C(  5764),  INT16_C(  4743),
        -INT16_C( 14263), -INT16_C(  6866), -INT16_C(  2492), -INT16_C(  6004),       INT16_MIN, -INT16_C(  2844),  INT16_C(  4066), -INT16_C( 30234) } },
    { {  INT16_C(  9918), -INT16_C( 23422),  INT16_C( 19823),  INT16_C( 29400), -INT16_C(  2653), -INT16_C( 17275), -INT16_C(  6645), -INT16_C( 12601),
        -INT16_C( 13936),  INT16_C(  7821),  INT16_C(  5043),  INT16_C( 16980),  INT16_C( 25036), -INT16_C( 13026), -INT16_C( 23684),  INT16_C( 15046),
         INT16_C( 18634),  INT16_C( 14814), -INT16_C( 18795),  INT16_C( 14507),  INT16_C( 12459), -INT16_C( 18700), -INT16_C( 17642), -INT16_C( 22907),
         INT16_C(  4741),  INT16_C( 14532),  INT16_C(  6181), -INT16_C(  3717), -INT16_C( 26247), -INT16_C(  2626), -INT16_C( 31684),  INT16_C(  1584) },
      UINT32_C(1631588044),
      { UINT8_C(197), UINT8_C(235), UINT8_C(153), UINT8_C(112), UINT8_C( 28), UINT8_C(142), UINT8_C( 39), UINT8_C( 50),
        UINT8_C( 73), UINT8_C(172), UINT8_C(217), UINT8_C(206), UINT8_C(190), UINT8_C(157), UINT8_C(  7), UINT8_C(227),
        UINT8_C(182), UINT8_C(130), UINT8_C(213), UINT8_C( 47), UINT8_C( 27), UINT8_C(147), UINT8_C( 37), UINT8_C( 87),
        UINT8_C( 24), UINT8_C( 85), UINT8_C( 94), UINT8_C(228), UINT8_C( 99), UINT8_C(158), UINT8_C( 70), UINT8_C( 40),
        UINT8_C(137), UINT8_C(223), UINT8_C(153), UINT8_C(165), UINT8_C(109), UINT8_C(192), UINT8_C(216), UINT8_C(183),
        UINT8_C(108), UINT8_C(177), UINT8_C(133), UINT8_C( 42), UINT8_C( 78), UINT8_C(140), UINT8_C( 13), UINT8_C(  4),
        UINT8_C( 14), UINT8_C(226), UINT8_C( 52), UINT8_C( 41), UINT8_C(118), UINT8_C( 89), UINT8_C(129), UINT8_C(142),
        UINT8_C(174), UINT8_C(223), UINT8_C(114), UINT8_C( 17), UINT8_C(125), UINT8_C(184), UINT8_C( 58), UINT8_C(  6) },
      { -INT8_C( 104), -INT8_C(  45), -INT8_C(  84),  INT8_C(   5), -INT8_C( 109), -INT8_C( 124), -INT8_C(  68), -INT8_C(   1),
         INT8_C(  53),  INT8_C(  66),  INT8_C(  41), -INT8_C( 125), -INT8_C(  50),  INT8_C(  54), -INT8_C( 120), -INT8_C(  35),
         INT8_C(  25), -INT8_C(  68),  INT8_C(   6), -INT8_C( 113),  INT8_C(  21), -INT8_C( 121),  INT8_C(  29), -INT8_C(  61),
         INT8_C( 102), -INT8_C( 113), -INT8_C(  44), -INT8_C(  29),  INT8_C(  72),  INT8_C(  14), -INT8_C(  22), -INT8_C(  32),
        -INT8_C(  31), -INT8_C( 106), -INT8_C(  27),  INT8_C( 116),  INT8_C(  26), -INT8_C(  94),  INT8_C( 115),  INT8_C(  79),
        -INT8_C(  28), -INT8_C( 100), -INT8_C(  46), -INT8_C(  78), -INT8_C(  45),  INT8_C(  90), -INT8_C( 113), -INT8_C(  20),
         INT8_C(  22), -INT8_C( 106),  INT8_C( 123),  INT8_C(  43),  INT8_C(  29), -INT8_C( 104), -INT8_C(  18), -INT8_C( 124),
         INT8_C(  39), -INT8_C(  61),  INT8_C( 103),  INT8_C( 111), -INT8_C(  47),  INT8_C(  81),  INT8_C(  79), -INT8_C(  77) },
      {  INT16_C(  9918), -INT16_C( 23422), -INT16_C( 20660), -INT16_C(  2702), -INT16_C(  2653), -INT16_C( 17275), -INT16_C(  1022), -INT16_C(  8785),
        -INT16_C( 13936), -INT16_C(  4033), -INT16_C( 17220), -INT16_C(  4234),  INT16_C( 25036), -INT16_C( 13026), -INT16_C( 23684),  INT16_C( 15046),
         INT16_C( 18634),  INT16_C( 14814), -INT16_C( 18795),  INT16_C( 14507),  INT16_C( 12459), -INT16_C( 18700),  INT16_C(  9090), -INT16_C( 22907),
        -INT16_C( 23648),  INT16_C( 14532),  INT16_C(  6181), -INT16_C(  3717), -INT16_C( 26247),  INT16_C( 13629),  INT16_C(  9029),  INT16_C(  1584) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m512i src = simde_mm512_loadu_epi16(test_vec[i].src);
    simde__m512i a = simde_mm512_loadu_epi16(test_vec[i].a);
    simde__m512i b = simde_mm512_loadu_epi16(test_vec[i].b);
    simde__m512i r = simde_mm512_mask_maddubs_epi16(src, test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x32(r, simde_mm512_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

static int
test_simde_mm512_maskz_maddubs_epi16 (SIMDE_MUNIT_TEST_ARGS) {
  static const struct {
    const simde__mmask32 k;
    const uint8_t a[64];
    const int8_t  b[64];
    const int16_t r[32];
  } test_vec[] = {
    { UINT32_C(3811114610),
      { UINT8_C(135), UINT8_C(200), UINT8_C(106), UINT8_C(105), UINT8_C(126), UINT8_C(142), UINT8_C(239), UINT8_C(162),
        UINT8_C(217), UINT8_C(212), UINT8_C( 72), UINT8_C( 90), UINT8_C(193), UINT8_C(229), UINT8_C( 33), UINT8_C(125),
        UINT8_C(124), UINT8_C(173), UINT8_C(179), UINT8_C( 78), UINT8_C( 35), UINT8_C(142), UINT8_C(224), UINT8_C(190),
        UINT8_C(117), UINT8_C(252), UINT8_C(166), UINT8_C(232), UINT8_C(250), UINT8_C(207), UINT8_C(203), UINT8_C(129),
        UINT8_C(151), UINT8_C( 53), UINT8_C(234), UINT8_C( 21), UINT8_C(195), UINT8_C(217), UINT8_C(183), UINT8_C(156),
        UINT8_C(174), UINT8_C(  0), UINT8_C(246), UINT8_C(111), UINT8_C(229), UINT8_C( 23), UINT8_C(236), UINT8_C( 97),
        UINT8_C(197), UINT8_C(160), UINT8_C(176), UINT8_C(232), UINT8_C( 46), UINT8_C(144), UINT8_C(166), UINT8_C(163),
        UINT8_C(140), UINT8_C( 76), UINT8_C(139), UINT8_C(134), UINT8_C( 27), UINT8_C( 86), UINT8_C(  8), UINT8_C(178) },
      { -INT8_C( 117), -INT8_C(  14), -INT8_C(  57),  INT8_C(  79), -INT8_C(  52),      INT8_MAX, -INT8_C(  21),  INT8_C( 122),
             INT8_MAX, -INT8_C(  30), -INT8_C(  23),  INT8_C( 100), -INT8_C(   7), -INT8_C(  43), -INT8_C(  58), -INT8_C(  66),
         INT8_C( 117),  INT8_C( 118), -INT8_C(  90), -INT8_C(  93),  INT8_C(   6),  INT8_C(  76),  INT8_C(  71), -INT8_C( 109),
        -INT8_C( 103), -INT8_C(  46),  INT8_C(  25), -INT8_C(  76),  INT8_C(  41),  INT8_C(  33),  INT8_C( 103), -INT8_C(  76),
         INT8_C(  20),  INT8_C(  46),  INT8_C(   3), -INT8_C(  32), -INT8_C(  83), -INT8_C(  17),  INT8_C(  90),  INT8_C(  44),
        -INT8_C(  47),  INT8_C(  67), -INT8_C( 111), -INT8_C(  54),  INT8_C(  24),  INT8_C(  87), -INT8_C( 119), -INT8_C( 114),
        -INT8_C(  51),  INT8_C(  47),  INT8_C(  49), -INT8_C(  45),  INT8_C( 124),  INT8_C( 120),  INT8_C( 102),  INT8_C(  21),
         INT8_C(  75),      INT8_MIN, -INT8_C(  55),  INT8_C( 116), -INT8_C(  95),  INT8_C(  48),  INT8_C(  40), -INT8_C(  75) },
      {  INT16_C(     0),  INT16_C(  2253),  INT16_C(     0),  INT16_C(     0),  INT16_C( 21199),  INT16_C(  7344), -INT16_C( 11198),  INT16_C(     0),
         INT16_C(     0), -INT16_C( 23364),  INT16_C( 11002), -INT16_C(  4806), -INT16_C( 23643), -INT16_C( 13482),  INT16_C( 17081),  INT16_C( 11105),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C( 23334),  INT16_C(     0),       INT16_MIN,  INT16_C(     0),  INT16_C(     0),
        -INT16_C(  2527), -INT16_C(  1816),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7899),  INT16_C(  1563), -INT16_C( 13030) } },
    { UINT32_C( 211102815),
      { UINT8_C( 27), UINT8_C(239), UINT8_C( 57), UINT8_C(236), UINT8_C( 50), UINT8_C(202), UINT8_C(182), UINT8_C( 75),
        UINT8_C( 33), UINT8_C( 63), UINT8_C(217), UINT8_C(238), UINT8_C(111), UINT8_C( 10), UINT8_C(193), UINT8_C(235),
        UINT8_C(131), UINT8_C( 40), UINT8_C(  0), UINT8_C(206), UINT8_C(168), UINT8_C(201), UINT8_C( 66), UINT8_C( 73),
        UINT8_C(250), UINT8_C(106),    UINT8_MAX, UINT8_C( 89), UINT8_C(150), UINT8_C(148), UINT8_C(101), UINT8_C(177),
        UINT8_C(132), UINT8_C(158), UINT8_C(157), UINT8_C(182), UINT8_C(104), UINT8_C( 84), UINT8_C(  1), UINT8_C(137),
        UINT8_C(147), UINT8_C(218), UINT8_C(119), UINT8_C(  2), UINT8_C(229), UINT8_C( 57), UINT8_C(237), UINT8_C(104),
        UINT8_C( 97), UINT8_C(237), UINT8_C( 54), UINT8_C(  9), UINT8_C(183), UINT8_C(120), UINT8_C( 82), UINT8_C(177),
        UINT8_C(226), UINT8_C( 81), UINT8_C( 10), UINT8_C(121), UINT8_C(230), UINT8_C(111), UINT8_C( 42), UINT8_C(106) },
      {  INT8_C(  14), -INT8_C(  56),  INT8_C(  32),  INT8_C( 118),  INT8_C(  28),  INT8_C(  34),  INT8_C(   0), -INT8_C(  81),
        -INT8_C(   4),  INT8_C( 119), -INT8_C(  78), -INT8_C(  31), -INT8_C(  80), -INT8_C(  97),  INT8_C(  73),  INT8_C(  17),
        -INT8_C( 115),      INT8_MAX,  INT8_C(  26),  INT8_C(  68), -INT8_C(   9),  INT8_C( 109), -INT8_C(  11), -INT8_C(  38),
        -INT8_C(  66), -INT8_C(   1),  INT8_C(  83), -INT8_C(  92),  INT8_C( 110),  INT8_C( 125),  INT8_C(  14),  INT8_C( 124),
         INT8_C(  69),  INT8_C(  47), -INT8_C(  13),  INT8_C(  97),  INT8_C(  81), -INT8_C(  13),  INT8_C(  17),  INT8_C(  77),
         INT8_C( 106), -INT8_C(  61),  INT8_C(  47),  INT8_C(  27),  INT8_C(  98),  INT8_C( 120),  INT8_C(  44), -INT8_C(  17),
        -INT8_C(   8),  INT8_C(  71),  INT8_C(  51), -INT8_C(  17), -INT8_C(  76),  INT8_C(  40), -INT8_C(  55),  INT8_C( 114),
         INT8_C(  39),  INT8_C(  28),  INT8_C(  23), -INT8_C( 106), -INT8_C( 102),  INT8_C(  37),  INT8_C(  18), -INT8_C(  33) },
      { -INT16_C( 13006),  INT16_C( 29672),  INT16_C(  8268), -INT16_C(  6075),  INT16_C(  7365),  INT16_C(     0), -INT16_C(  9850),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0),  INT16_C( 20397), -INT16_C(  3500),  INT16_C(     0),  INT16_C( 12977),  INT16_C(     0),  INT16_C(     0),
         INT16_C( 16534),  INT16_C(     0),  INT16_C(  7332),  INT16_C(     0),  INT16_C(  2284),  INT16_C(     0),  INT16_C(     0),  INT16_C(  8660),
         INT16_C(     0),  INT16_C(     0), -INT16_C(  9108),  INT16_C( 15668),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0) } },
    { UINT32_C(2772501844),
      { UINT8_C(248), UINT8_C( 82), UINT8_C(243), UINT8_C( 99), UINT8_C( 21), UINT8_C( 34), UINT8_C(126), UINT8_C(119),
        UINT8_C(154), UINT8_C(170), UINT8_C(103), UINT8_C(146), UINT8_C(241), UINT8_C(154), UINT8_C(130), UINT8_C(165),
        UINT8_C(195), UINT8_C( 75), UINT8_C( 24), UINT8_C(234), UINT8_C(104), UINT8_C( 47), UINT8_C(128), UINT8_C(  2),
        UINT8_C( 84), UINT8_C(147), UINT8_C(225), UINT8_C(169), UINT8_C(152), UINT8_C( 34), UINT8_C( 78), UINT8_C(145),
        UINT8_C(116), UINT8_C( 65), UINT8_C(244), UINT8_C(137), UINT8_C( 99), UINT8_C(114), UINT8_C(  1), UINT8_C(254),
        UINT8_C( 28), UINT8_C(104), UINT8_C(144), UINT8_C( 14), UINT8_C(  2), UINT8_C( 18), UINT8_C(179), UINT8_C(197),
        UINT8_C( 94), UINT8_C(203), UINT8_C(176), UINT8_C(198), UINT8_C(250), UINT8_C( 48), UINT8_C(200), UINT8_C( 79),
        UINT8_C(195), UINT8_C(169), UINT8_C(248), UINT8_C( 92), UINT8_C(204), UINT8_C( 70), UINT8_C(237), UINT8_C( 64) },
      { -INT8_C( 120), -INT8_C(  31), -INT8_C(  54), -INT8_C(  21),  INT8_C(  83), -INT8_C(  53), -INT8_C(  23),  INT8_C( 111),
         INT8_C(  51),  INT8_C( 122),  INT8_C( 125),  INT8_C(  53), -INT8_C( 116),  INT8_C(  49), -INT8_C(   5), -INT8_C(  22),
        -INT8_C(   4), -INT8_C(  85), -INT8_C(  80), -INT8_C(   9), -INT8_C(  37),  INT8_C( 120),  INT8_C(  70), -INT8_C(  97),
         INT8_C(  34),  INT8_C(  62), -INT8_C(   5), -INT8_C(  18), -INT8_C( 124), -INT8_C(  24),  INT8_C(  46),  INT8_C(  12),
        -INT8_C(  55), -INT8_C(   8), -INT8_C(   8),  INT8_C(  28), -INT8_C(  61), -INT8_C(  31), -INT8_C( 117), -INT8_C(  10),
         INT8_C(  91),  INT8_C(   9),  INT8_C(  44), -INT8_C(  24),  INT8_C(  58),  INT8_C(  39), -INT8_C(  46),  INT8_C(  54),
        -INT8_C(  46), -INT8_C( 125),  INT8_C(  45), -INT8_C(  83), -INT8_C(   5),  INT8_C( 115),  INT8_C(  76),  INT8_C(  29),
        -INT8_C(  79),  INT8_C(  71),  INT8_C(  11),  INT8_C(  54),  INT8_C(  47),  INT8_C(  58),  INT8_C(  66), -INT8_C(   8) },
      {  INT16_C(     0),  INT16_C(     0), -INT16_C(    59),  INT16_C(     0),  INT16_C( 28594),  INT16_C(     0), -INT16_C( 20410),  INT16_C(     0),
        -INT16_C(  7155),  INT16_C(     0),  INT16_C(  1792),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
        -INT16_C(  6900),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(   818),  INT16_C(     0),
        -INT16_C( 29699),  INT16_C(     0),  INT16_C(  4270),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7696),  INT16_C(     0),  INT16_C( 15130) } },
    { UINT32_C(4128520754),
      { UINT8_C( 28), UINT8_C(160), UINT8_C(236), UINT8_C(119), UINT8_C(169), UINT8_C( 24), UINT8_C( 95), UINT8_C(227),
        UINT8_C( 63), UINT8_C( 50), UINT8_C( 25), UINT8_C( 17), UINT8_C(181), UINT8_C( 71), UINT8_C(191), UINT8_C(176),
        UINT8_C(186), UINT8_C( 11), UINT8_C(206), UINT8_C(108), UINT8_C( 83), UINT8_C(217), UINT8_C(162), UINT8_C(130),
        UINT8_C( 19), UINT8_C(228), UINT8_C(123), UINT8_C( 70), UINT8_C( 31), UINT8_C(143), UINT8_C( 60), UINT8_C( 59),
        UINT8_C( 47), UINT8_C( 40), UINT8_C(178), UINT8_C(216), UINT8_C( 65), UINT8_C( 18), UINT8_C(187), UINT8_C(128),
        UINT8_C( 68), UINT8_C(213), UINT8_C(146), UINT8_C(249), UINT8_C( 28), UINT8_C( 81), UINT8_C(169), UINT8_C(214),
        UINT8_C( 92), UINT8_C(119), UINT8_C( 66), UINT8_C(175), UINT8_C( 81), UINT8_C(228), UINT8_C( 50), UINT8_C(100),
        UINT8_C(201), UINT8_C(173), UINT8_C(170), UINT8_C(232), UINT8_C( 60), UINT8_C(230), UINT8_C( 35), UINT8_C(108) },
      {  INT8_C(  15), -INT8_C(  43),  INT8_C(  68),  INT8_C(  80), -INT8_C(  25),  INT8_C(   0), -INT8_C(  48),  INT8_C(  43),
        -INT8_C(  43),  INT8_C(  98),  INT8_C(  36), -INT8_C(  15), -INT8_C(  77), -INT8_C(  50), -INT8_C(  57),  INT8_C(  16),
         INT8_C(  69),  INT8_C(  10), -INT8_C(  65), -INT8_C( 106), -INT8_C(  18), -INT8_C(  15), -INT8_C(   5), -INT8_C(  73),
        -INT8_C(  98), -INT8_C(  91), -INT8_C(  97), -INT8_C(  37), -INT8_C( 116), -INT8_C(  62),  INT8_C(  71), -INT8_C( 101),
        -INT8_C( 104), -INT8_C( 117), -INT8_C(  21),      INT8_MAX, -INT8_C( 117), -INT8_C(  69), -INT8_C(  85),  INT8_C(  96),
         INT8_C(  30), -INT8_C(  49),  INT8_C(  81), -INT8_C(  47), -INT8_C(  99),  INT8_C(  25), -INT8_C(  31), -INT8_C(  29),
         INT8_C(  35), -INT8_C(  95),  INT8_C( 121),  INT8_C(  17), -INT8_C( 110),  INT8_C( 116), -INT8_C(  55),  INT8_C(  49),
         INT8_C(  26),  INT8_C( 104),  INT8_C(  12), -INT8_C(  90),  INT8_C(  43),  INT8_C(  83),  INT8_C(  65), -INT8_C(  61) },
      {  INT16_C(     0),  INT16_C( 25568),  INT16_C(     0),  INT16_C(     0),  INT16_C(  2191),  INT16_C(   645),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0), -INT16_C( 24838),  INT16_C(     0), -INT16_C( 10300), -INT16_C( 22610), -INT16_C( 14521),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0), -INT16_C(  8847),  INT16_C(     0), -INT16_C(  8397),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0),  INT16_C( 10961),  INT16_C( 17538),  INT16_C(     0),  INT16_C( 23218), -INT16_C( 18840),  INT16_C( 21670), -INT16_C(  4313) } },
    { UINT32_C(1782721758),
      { UINT8_C(231), UINT8_C(237), UINT8_C(202), UINT8_C(  5), UINT8_C(189), UINT8_C( 28), UINT8_C(215), UINT8_C( 90),
        UINT8_C( 53), UINT8_C(184), UINT8_C( 61), UINT8_C( 88), UINT8_C( 89), UINT8_C(183), UINT8_C(105), UINT8_C(236),
        UINT8_C( 43), UINT8_C( 50), UINT8_C( 29), UINT8_C( 69), UINT8_C(155), UINT8_C( 41), UINT8_C(235), UINT8_C(198),
        UINT8_C(124), UINT8_C( 44), UINT8_C(137), UINT8_C( 90), UINT8_C( 88), UINT8_C(203), UINT8_C(196), UINT8_C( 64),
        UINT8_C(185), UINT8_C(143), UINT8_C( 69), UINT8_C(118), UINT8_C(171), UINT8_C( 28), UINT8_C(208), UINT8_C(224),
        UINT8_C(213), UINT8_C( 14), UINT8_C( 56), UINT8_C( 46), UINT8_C(197), UINT8_C(161), UINT8_C( 26), UINT8_C(240),
        UINT8_C(212), UINT8_C( 55), UINT8_C( 54), UINT8_C(111), UINT8_C( 96), UINT8_C( 33), UINT8_C( 53), UINT8_C(220),
        UINT8_C( 78), UINT8_C(190), UINT8_C( 55), UINT8_C(166), UINT8_C(137), UINT8_C(251), UINT8_C(230), UINT8_C( 66) },
      { -INT8_C( 118),  INT8_C(  44), -INT8_C(  72),  INT8_C(  53),  INT8_C(  72), -INT8_C( 119),  INT8_C(  21),  INT8_C(  29),
        -INT8_C( 105),  INT8_C(  77),  INT8_C(  76),  INT8_C(  92), -INT8_C(  17),  INT8_C( 102),  INT8_C(  76), -INT8_C(  61),
        -INT8_C(  98), -INT8_C( 126),  INT8_C(  50), -INT8_C(   2), -INT8_C(  92),  INT8_C( 103), -INT8_C(  37), -INT8_C(  14),
         INT8_C(  37),  INT8_C(  18), -INT8_C( 104), -INT8_C(  82),  INT8_C(  13),      INT8_MAX, -INT8_C(  15), -INT8_C( 104),
        -INT8_C(  85), -INT8_C(  87), -INT8_C(  51), -INT8_C(  13),  INT8_C(  50), -INT8_C(  29),  INT8_C(  17), -INT8_C(  55),
         INT8_C(  48),  INT8_C(  93),  INT8_C(  37),  INT8_C(  31), -INT8_C(  61),  INT8_C( 114), -INT8_C(  30),  INT8_C(  97),
        -INT8_C(  12),  INT8_C(  20),  INT8_C(  96), -INT8_C( 104),  INT8_C( 123),  INT8_C(  59), -INT8_C( 118), -INT8_C(  96),
         INT8_C(  77),  INT8_C(  35),  INT8_C(  79),  INT8_C(  90), -INT8_C(  94),  INT8_C(  64), -INT8_C(  14),  INT8_C(  77) },
      {  INT16_C(     0), -INT16_C( 14279),  INT16_C( 10276),  INT16_C(  7125),  INT16_C(  8603),  INT16_C(     0),  INT16_C( 17153), -INT16_C(  6416),
         INT16_C(     0),  INT16_C(     0), -INT16_C( 10037), -INT16_C( 11467),  INT16_C(     0), -INT16_C( 21628),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0), -INT16_C(  5053),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  6337),  INT16_C(     0),
         INT16_C(     0), -INT16_C(  6360),  INT16_C(     0), -INT16_C( 27374),  INT16_C(     0),  INT16_C( 19285),  INT16_C(  3186),  INT16_C(     0) } },
    { UINT32_C( 474005737),
      { UINT8_C(163), UINT8_C( 81), UINT8_C(229), UINT8_C(211), UINT8_C(174), UINT8_C( 11), UINT8_C(243), UINT8_C(114),
        UINT8_C(125), UINT8_C(213), UINT8_C(211), UINT8_C(113), UINT8_C(234), UINT8_C( 51), UINT8_C( 10), UINT8_C(101),
        UINT8_C(110), UINT8_C(148), UINT8_C(  6), UINT8_C(187), UINT8_C(183), UINT8_C( 85), UINT8_C( 22), UINT8_C( 89),
        UINT8_C(149), UINT8_C(  8), UINT8_C(166), UINT8_C(126), UINT8_C(200), UINT8_C(231), UINT8_C(154), UINT8_C(107),
        UINT8_C( 56), UINT8_C(128), UINT8_C( 63), UINT8_C(231), UINT8_C(139), UINT8_C( 50), UINT8_C( 89), UINT8_C(  8),
        UINT8_C(  7), UINT8_C( 44), UINT8_C(121), UINT8_C(241), UINT8_C( 96), UINT8_C(131), UINT8_C( 87), UINT8_C(206),
        UINT8_C( 24), UINT8_C( 93), UINT8_C(138), UINT8_C(207), UINT8_C(178), UINT8_C(160), UINT8_C( 41), UINT8_C( 71),
        UINT8_C(168), UINT8_C(207), UINT8_C(197), UINT8_C(113), UINT8_C(182), UINT8_C( 96), UINT8_C(220), UINT8_C(239) },
      { -INT8_C(  32),  INT8_C(  27), -INT8_C(  42),  INT8_C( 107),  INT8_C(  77),  INT8_C(  47),  INT8_C( 115),  INT8_C(  85),
         INT8_C(  91), -INT8_C(  20),  INT8_C(  70), -INT8_C(  69),  INT8_C( 112), -INT8_C(  99), -INT8_C( 118), -INT8_C( 120),
        -INT8_C(   6),  INT8_C(  20),  INT8_C(  87), -INT8_C(  84), -INT8_C(  76),      INT8_MIN, -INT8_C(  13),  INT8_C(  92),
         INT8_C(  80), -INT8_C(  71), -INT8_C(  51),  INT8_C(   6),  INT8_C(  25), -INT8_C(  86), -INT8_C(  11), -INT8_C(   7),
        -INT8_C(  59), -INT8_C(  53),  INT8_C( 100),  INT8_C(  19), -INT8_C(   6), -INT8_C(  41),  INT8_C( 104),  INT8_C(  86),
        -INT8_C(  61), -INT8_C(  82),  INT8_C(  17),  INT8_C(  51),  INT8_C(  76), -INT8_C( 101), -INT8_C(  69),  INT8_C(  70),
        -INT8_C(  81),  INT8_C(  19), -INT8_C(  13),  INT8_C(  99), -INT8_C( 109), -INT8_C(  26), -INT8_C(  64), -INT8_C(  29),
        -INT8_C(  97), -INT8_C( 115), -INT8_C(  22), -INT8_C(  72),  INT8_C(  55), -INT8_C(  33), -INT8_C(  79), -INT8_C(   3) },
      { -INT16_C(  3029),  INT16_C(     0),  INT16_C(     0),       INT16_MAX,  INT16_C(     0),  INT16_C(  6973),  INT16_C( 21159), -INT16_C( 13300),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 14866), -INT16_C(  2443),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C(  5935),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0), -INT16_C( 23562), -INT16_C(  4683),       INT16_MIN,  INT16_C(     0),  INT16_C(     0),  INT16_C(     0) } },
    { UINT32_C(2769294763),
      { UINT8_C(236), UINT8_C(120), UINT8_C(251), UINT8_C(176), UINT8_C( 38), UINT8_C( 13), UINT8_C(227), UINT8_C(114),
        UINT8_C(168), UINT8_C(159), UINT8_C(185), UINT8_C( 88), UINT8_C(178), UINT8_C(172), UINT8_C(187), UINT8_C( 69),
        UINT8_C(146), UINT8_C(123), UINT8_C( 41), UINT8_C( 50), UINT8_C(  9), UINT8_C( 19), UINT8_C(234), UINT8_C( 64),
        UINT8_C(242), UINT8_C(156), UINT8_C( 61), UINT8_C(157), UINT8_C(177), UINT8_C( 77), UINT8_C( 67), UINT8_C(158),
        UINT8_C(197), UINT8_C( 62), UINT8_C( 78), UINT8_C(236), UINT8_C( 75), UINT8_C( 49), UINT8_C( 94), UINT8_C(244),
        UINT8_C(208), UINT8_C( 23), UINT8_C( 76), UINT8_C(130), UINT8_C(195), UINT8_C(  7), UINT8_C(200), UINT8_C( 86),
        UINT8_C(131), UINT8_C(241), UINT8_C(136), UINT8_C(140), UINT8_C(  4), UINT8_C(114), UINT8_C(204), UINT8_C(246),
        UINT8_C( 14), UINT8_C( 10), UINT8_C(148), UINT8_C(192), UINT8_C( 87), UINT8_C(215), UINT8_C( 94), UINT8_C( 29) },
      {  INT8_C(  21), -INT8_C(  84),  INT8_C(   9),  INT8_C(  97), -INT8_C(  35),  INT8_C( 103),  INT8_C(  85), -INT8_C(  82),
             INT8_MAX, -INT8_C(  95),  INT8_C(  48),  INT8_C(  66), -INT8_C(  88), -INT8_C(   8), -INT8_C( 104),  INT8_C(  43),
        -INT8_C(  23),  INT8_C(  32), -INT8_C(  73), -INT8_C(  19), -INT8_C( 109), -INT8_C( 124), -INT8_C(  28), -INT8_C(  95),
        -INT8_C( 114),  INT8_C( 120),  INT8_C(  97), -INT8_C(  27),  INT8_C(  79), -INT8_C(  65),  INT8_C(   2),  INT8_C( 100),
         INT8_C( 107),  INT8_C(  11), -INT8_C(  59),  INT8_C(  73),  INT8_C( 115),  INT8_C(  26), -INT8_C(   9), -INT8_C(  14),
        -INT8_C(  69),  INT8_C(  39),  INT8_C(  52),  INT8_C( 100),  INT8_C(  32), -INT8_C(  51), -INT8_C( 113),  INT8_C(   9),
        -INT8_C(  19),  INT8_C(  71), -INT8_C(   9),      INT8_MIN, -INT8_C(  53), -INT8_C(  37),  INT8_C(  34),  INT8_C(  89),
         INT8_C(  83), -INT8_C( 125),  INT8_C(  62), -INT8_C(  94),  INT8_C(  67),  INT8_C(  65),  INT8_C(   6), -INT8_C(  82) },
      { -INT16_C(  5124),  INT16_C( 19331),  INT16_C(     0),  INT16_C(  9947),  INT16_C(     0),  INT16_C( 14688),  INT16_C(     0), -INT16_C( 16481),
         INT16_C(   578),  INT16_C(     0), -INT16_C(  3337),  INT16_C(     0), -INT16_C(  8868),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 13455),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
         INT16_C( 14622),  INT16_C(     0), -INT16_C(  4430),  INT16_C(     0),  INT16_C(     0), -INT16_C(  8872),  INT16_C(     0), -INT16_C(  1814) } },
    { UINT32_C(3220687948),
      { UINT8_C(230), UINT8_C(238), UINT8_C(177), UINT8_C(162), UINT8_C( 22), UINT8_C(230), UINT8_C(  6), UINT8_C( 54),
        UINT8_C(179), UINT8_C(149), UINT8_C( 63), UINT8_C(160), UINT8_C(220), UINT8_C( 54), UINT8_C( 33), UINT8_C(167),
        UINT8_C( 17), UINT8_C( 67), UINT8_C(  0), UINT8_C(100), UINT8_C(198), UINT8_C( 63), UINT8_C(  6), UINT8_C(  9),
        UINT8_C(128), UINT8_C( 13), UINT8_C(184), UINT8_C(204), UINT8_C(217), UINT8_C(175), UINT8_C(140), UINT8_C(191),
        UINT8_C(158), UINT8_C( 61), UINT8_C( 97), UINT8_C(180), UINT8_C( 35), UINT8_C(103), UINT8_C(234), UINT8_C(214),
        UINT8_C(253), UINT8_C( 41), UINT8_C(119), UINT8_C(217), UINT8_C( 96), UINT8_C(152), UINT8_C(129), UINT8_C(113),
        UINT8_C(219), UINT8_C(129), UINT8_C(214), UINT8_C(161), UINT8_C(192), UINT8_C(220), UINT8_C(171), UINT8_C( 64),
        UINT8_C(233), UINT8_C( 99), UINT8_C( 13), UINT8_C(194), UINT8_C( 18), UINT8_C(153), UINT8_C(130), UINT8_C(176) },
      { -INT8_C(  42), -INT8_C(  29),  INT8_C( 100), -INT8_C(   6),  INT8_C(  75),  INT8_C(  78), -INT8_C(  48),  INT8_C(  72),
         INT8_C( 120),  INT8_C(  71),  INT8_C(  33), -INT8_C(  40), -INT8_C(  33), -INT8_C(  94),  INT8_C(  73), -INT8_C(  70),
         INT8_C(  36),  INT8_C(  31),  INT8_C(  92), -INT8_C(  28), -INT8_C(   4),  INT8_C(   7),  INT8_C(  37), -INT8_C(  27),
         INT8_C( 106),  INT8_C(  50), -INT8_C(  88),  INT8_C( 124), -INT8_C(  53),  INT8_C(  42),  INT8_C(  45), -INT8_C(  95),
         INT8_C(  13), -INT8_C( 111), -INT8_C( 101),  INT8_C(  88), -INT8_C(  32),  INT8_C( 108), -INT8_C(  96),  INT8_C(  88),
        -INT8_C(  77), -INT8_C(  62),  INT8_C(  48), -INT8_C( 109),  INT8_C( 100),  INT8_C( 121),  INT8_C(  77), -INT8_C( 120),
        -INT8_C( 103), -INT8_C(  87),  INT8_C( 109), -INT8_C( 107), -INT8_C(  80), -INT8_C( 110),  INT8_C( 122),  INT8_C(  26),
        -INT8_C(  60),  INT8_C(  34), -INT8_C( 105), -INT8_C( 113),  INT8_C(  76), -INT8_C(  60),  INT8_C(  48),  INT8_C(  90) },
      {  INT16_C(     0),  INT16_C(     0),  INT16_C( 19590),  INT16_C(  3600),  INT16_C(     0),  INT16_C(     0), -INT16_C( 12336),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0), -INT16_C(   351), -INT16_C(    21),  INT16_C(     0),  INT16_C(     0), -INT16_C(  4151), -INT16_C( 11845),
        -INT16_C(  4717),  INT16_C(  6043),  INT16_C( 10004),  INT16_C(     0), -INT16_C( 22023), -INT16_C( 17941),  INT16_C( 27992), -INT16_C(  3627),
              INT16_MIN,  INT16_C(  6099),       INT16_MIN,  INT16_C( 22526), -INT16_C( 10614), -INT16_C( 23287),  INT16_C(     0),  INT16_C( 22080) } },
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde__m512i a = simde_mm512_loadu_epi16(test_vec[i].a);
    simde__m512i b = simde_mm512_loadu_epi16(test_vec[i].b);
    simde__m512i r = simde_mm512_maskz_maddubs_epi16(test_vec[i].k, a, b);
    simde_test_x86_assert_equal_i16x32(r, simde_mm512_loadu_epi16(test_vec[i].r));
  }

  return 0;
}

SIMDE_TEST_FUNC_LIST_BEGIN
  SIMDE_TEST_FUNC_LIST_ENTRY(mm_mask_maddubs_epi16)
  SIMDE_TEST_FUNC_LIST_ENTRY(mm_maskz_maddubs_epi16)

  SIMDE_TEST_FUNC_LIST_ENTRY(mm256_mask_maddubs_epi16)
  SIMDE_TEST_FUNC_LIST_ENTRY(mm256_maskz_maddubs_epi16)

  SIMDE_TEST_FUNC_LIST_ENTRY(mm512_maddubs_epi16)
  SIMDE_TEST_FUNC_LIST_ENTRY(mm512_mask_maddubs_epi16)
  SIMDE_TEST_FUNC_LIST_ENTRY(mm512_maskz_maddubs_epi16)
SIMDE_TEST_FUNC_LIST_END

#include <test/x86/avx512/test-avx512-footer.h>
